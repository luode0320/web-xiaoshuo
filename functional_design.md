# 小说阅读系统功能设计文档

## 项目概述

本项目是一个小说阅读系统，支持多种格式的小说上传、阅读、搜索和社交功能。系统采用前后端分离架构，提供类似起点中文网的阅读体验。系统仅支持中文。

## 核心功能

### 1. 小说管理功能
- 小说上传：支持txt、epub格式小说文件上传，文件大小限制最大20MB，包含文件hash验证防止重复上传，上传失败时提示错误信息
- 小说列表：展示系统中的所有小说，支持无限滚动分页
- 小说详情：显示小说基本信息、简介、字数统计等
- 小说分类：按不同类型分类展示小说
- 阅读排行：按阅读次数排序展示小说（总榜、今日榜、本周榜、本月榜）
- 审核机制：上传后小说默认为审核中状态，可选择性过滤查看
- 分类设置：当本地存储阅读进度按照字数位置的百分比达到20%以上时，可以在最后一页为小说设置分类和关键词（简单判断，不需要额外验证）

### 2. 阅读功能
- 在线阅读：提供流畅的小说阅读体验（使用第三方库实现txt和epub格式解析）
- 阅读进度：自动保存用户阅读进度到本地存储（使用第三方库实现），按照字数位置的百分比存储和展示进度，用户再次打开的时候跳转到上次位置继续阅读（使用第三方库实现章节和页码定位）

- 个性化设置：字体大小（范围[12-100px]）、背景颜色（白、黑、灰三种选项）等阅读界面定制
- 阅读模式：支持滚动模式和翻页模式（通过第三方库实现）
- 翻页功能：点击阅读内容区域左侧30%实现上一页，点击右侧30%实现下页，支持覆盖翻页效果，可通过设置改成上下滚动翻页（使用第三方库实现翻页动画和流畅滚动）

### 3. 搜索功能
- 小说搜索：按标题、作者、主角名称、小说字数等信息搜索小说

- 分类搜索：按分类搜索小说
- 关键词搜索：按关键词搜索小说

### 4. 社交互动功能
- 评论系统：用户可以对小说章节进行评论，通过第三方库可以判断当前是否是每一章的最后一页，在该页面可以对小说的这一章节进行评论。前端要在每一章的最后可以提供评论的查看和用户提交评论，和对评论进行评论，评论用一个弹窗分页展示，弹窗中包含这一章的评论分页数据(点赞最多排序展示)，用户可以在弹窗的最下方一个输入框输入提交评论，评论的分页机制也是向下滚动刷新（使用第三方库实现，每页加载10条数据，滚动到距离底部20%时开始加载下一页）。每个用户对同一章节的评论数量限制为5条，评论内容通过前端基本验证后提交（使用第三方库实现）
- 评分系统：用户可以对小说进行评分，同时需要提供评分说明（用于对整个小说的评论展示，最多250个字符，非必填），评分支持点赞（同一个会话IP限制点赞一次，点赞状态在用户本地保存）


### 5. 分类管理功能
- 分类浏览：按分类浏览小说

## 界面设计

### 1. 底部导航栏
- 首页：推荐小说展示
- 分类：小说分类浏览
- 排行榜：阅读次数排行榜
- 上传：上传txt、epub格式小说

### 2. 首页
- 顶部搜索框：按名称、作者、主角名称、小说字数等搜索小说
- 推荐小说列表：展示推荐小说（名称、logo图片）
- 无限滚动加载更多小说（使用第三方库实现，每页加载10条数据，滚动到距离底部20%时开始加载下一页，当数据加载完毕后显示"已加载全部内容"提示）

### 3. 分类页
- 分类列表：展示各种小说分类
- 默认显示第一个分类的小说列表（名称、logo图片）
- 无限滚动加载更多小说（每页加载10条数据，滚动到距离底部20%时开始加载下一页）

### 4. 排行榜页
- 顶部时间范围选择：总榜、今日榜、本周榜、本月榜
- 排行榜列表：按点击量排序展示小说（名称、logo图片）
- 无限滚动加载更多小说（每页加载10条数据，滚动到距离底部20%时开始加载下一页）

### 5. 上传页
- 上传功能：支持单个或批量上传txt、epub格式文件
- 文件hash验证：上传前计算文件hash防止重复上传
- 上传进度显示：批量上传时每上传一个进度条就前进，直到所有的都上传完成；如果是单个文件，进度条从0到100变化，上传成功后显示100的进度。上传成功后自动刷新当前页面的小说列表（使用第三方库实现）
- 审核状态：上传后小说处于审核中状态
- 小说列表：默认展示审核中和已通过的小说
- 审核过滤：可选择是否过滤审核中的小说
- 无限滚动加载更多小说（每页加载10条数据，滚动到距离底部20%时开始加载下一页）

### 6. 小说详情页
- 小说封面和基本信息
- 分类信息展示
- 关键词展示
- 简介和作者信息（部分展示）
- 评分和评论统计
- 章节目录（通过解析小说文件自动生成和上传时提供，第三方库支持，用户可点击目录项跳转到对应章节，当前阅读位置高亮显示）
- 快速开始阅读按钮（点击右侧区域进入第一页，当用户对当前小说的阅读进度低于10%时记录阅读次数）
- 简介弹窗（点击简介可打开详细简介弹窗，居中显示，可右上角关闭）
- 评论弹窗（点击评论可打开评论列表弹窗，居中显示，可右上角关闭，支持滚动分页，默认每页显示5条评论，支持按点赞最多和最新排序，点赞最多为默认排序）
- 相关推荐（推荐拥有相同分类或者关键字的小说，按照阅读量排序的最多3本小说作为推荐，无阅读量小说默认按ID排序，排除本地存储的已读小说，向下滚动即可看到）

### 7. 阅读页
- 顶部工具栏：返回、设置、目录
- 阅读内容区域
- 设置面板：字体、主题、间距
- 目录面板：章节列表（通过解析小说文件自动生成和上传时提供，第三方库支持）
- 阅读模式：支持滚动模式和翻页模式（通过第三方库实现）
- 翻页功能：点击阅读内容区域左侧30%实现上一页，点击右侧30%实现下页，支持覆盖翻页效果，可通过设置改成上下滚动翻页（使用第三方库实现翻页动画和流畅滚动）
- 章节评论：通过第三方库判断当前是否是每一章的最后一页，在该页面可以对小说的这一章节进行评论，支持在弹窗中查看和提交评论
## 交互设计

### 1. 响应式设计
- 桌面端：充分利用屏幕空间，多列布局
- 平板端：适中的内容宽度，优化触摸操作
- 手机端：单列布局，简化导航

### 2. 用户体验
- 页面加载：骨架屏或加载动画
- 操作反馈：成功/失败提示
- 错误处理：友好的错误提示
- 无限滚动：自动加载更多内容
- 审核状态提示：明确显示小说审核状态

## 性能要求

### 1. 前端性能
- 页面加载时间 < 3秒
- 阅读页面响应时间 < 1秒
- 大型列表的高效渲染
- EPUB格式文件的快速解析

### 2. 后端性能
- API响应时间 < 500ms
- 数据库查询优化
- 静态资源加载优化
- 文件上传处理效率

## 安全要求

### 1. 数据安全
- 防止SQL注入
- 防止XSS攻击
- 输入内容过滤和验证

### 2. 文件安全
- 文件类型验证
- 文件大小限制
- 恶意文件检测
- 文件hash验证（防止重复上传）

## 部署方案

- 前后端分离部署
- 数据库独立部署
- 静态资源服务