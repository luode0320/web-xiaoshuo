# 小说阅读系统前端需求文档

## 项目概述

本项目前端部分是一个基于Vue.js的在线小说阅读系统，与Go后端API配合，
提供丰富的小说阅读体验。前端负责用户界面展示、交互逻辑处理和本地数据缓存。
系统主要面向移动端用户（手机阅读），同时兼容PC端。
系统仅支持中文。

### UI设计原则
- 移动优先设计：以移动端体验为核心进行设计
- 响应式布局：适配不同屏幕尺寸，包括手机、平板和PC端
- 阅读体验优化：
  - 参考起点中文网、微信读书、番茄免费小说等主流阅读平台的UI设计
  - 借鉴其阅读界面布局、字体选择、行间距设置、主题切换等设计元素
  - 采用简洁的界面设计，减少干扰元素，专注于内容阅读
- 组件化开发：使用第三方库不重复造轮子，功能模块分离，组件和工具类封装
- 界面简洁：减少不必要的视觉元素，突出小说内容本身
- 一致性原则：保持全站UI风格统一，包括颜色、字体、间距、圆角等设计元素

## 项目结构

```
frontend/
├── src/
│   ├── components/       # 通用组件
│   ├── views/            # 页面组件
│   ├── assets/           # 静态资源
│   ├── router/           # 路由配置
│   ├── utils/            # 工具函数
│   └── App.vue
├── public/               # 静态资源目录
├── package.json
└── vite.config.js
```

## 技术栈

- Vue.js 3.x
- Vue Router
- Pinia（状态管理）
- Composition API
- Vite（构建工具）
- Element Plus/Naive UI（UI组件库）
- TypeScript（可选）
- Axios（HTTP请求）
- epub.js（处理EPUB格式）
- js-sha256（文件hash验证）

## 功能模块

## 功能模块

### 1. 用户界面

#### 1.1 用户模块
- 用户注册：邮箱格式验证注册（使用第三方库vee-validate实现邮箱格式验证）
  - 注册时可选择填写昵称，若未填写则默认使用邮箱作为昵称
  - 使用第三方库validator.js进行邮箱格式验证
  - 表单验证规则：
    - 邮箱：必须符合邮箱格式
    - 密码：至少6位，包含字母和数字
    - 昵称：1-20个字符，不能包含特殊字符
  - 响应处理：注册成功后自动跳转到登录页面，并显示成功提示

- 用户登录：邮箱和密码登录（使用第三方库vee-validate实现表单验证）
  - 使用JWT进行认证
  - 表单验证规则：
    - 邮箱：必须符合邮箱格式
    - 密码：至少6位
  - 响应处理：登录成功后保存token到本地存储，跳转到首页，并显示欢迎提示
  - 错误处理：显示具体的错误信息（如邮箱不存在、密码错误等）

- 个人中心：展示用户基本信息、上传历史、评论历史、评分历史
  - 用户信息展示：
    - 邮箱（只读）
    - 昵称（可编辑）
    - 账户状态（活跃/冻结）
    - 管理员标识（仅管理员可见）
    - 注册时间
    - 最后登录时间
  - 功能入口：
    - 上传历史（分页展示用户上传的小说列表）
    - 评论历史（分页展示用户发布的评论列表）
    - 评分历史（分页展示用户提交的评分列表）
    - 系统消息（分页展示用户未读消息列表）
  - 操作功能：
    - 修改昵称（使用表单验证）
    - 安全退出（清除本地token和用户信息）
  - UI设计：
    - 整体布局：
      - 背景色：#f5f5f5（浅色模式）/ #1a1a1a（深色模式）
      - 顶部头像区域：高度31.25vw（约150px），背景渐变色，居中显示头像和昵称
      - 头像：尺寸16.7vw×16.7vw（约80px），圆角50%，边框0.4vw白色（约2px）
      - 昵称：3.75vw字体（约18px），白色，粗体，下方显示邮箱
      - 邮箱：2.9vw字体（约14px），白色，透明度0.8
    - 信息卡片区：
      - 账户信息卡片：白色背景，圆角1.7vw（约8px），阴影，内边距3.3vw（约16px）
      - 显示项目：账户状态、注册时间、最后登录时间等
      - 状态标签：活跃-绿色，冻结-红色，管理员-蓝色
    - 功能入口列表：
      - 统一样式：白色背景卡片，圆角1.7vw（约8px），高度10.4vw（约50px）
      - 左侧：图标（尺寸5vw×5vw，约24px）
      - 中间：功能名称（3.3vw字体，约16px）
      - 右侧：箭头图标，提示可点击
      - 分割线：卡片间有浅灰色分割线（#f0f0f0），高度0.2vw（约1px）
      - 点击反馈：轻微缩放动画
    - 具体功能项：
      - 上传历史：显示上传小说数量，最近上传时间
      - 评论历史：显示评论数量，最近评论时间
      - 评分历史：显示评分数量，平均评分
      - 系统消息：显示未读消息数量（红色徽章）
      - 关于我们：项目信息入口
      - 审核管理：仅管理员可见的功能入口
    - 操作按钮：
      - 修改昵称：按钮样式，主题色背景，圆角0.8vw（约4px）
      - 安全退出：红色按钮，确认弹窗
    - 冻结用户提示：
      - 顶部横幅：高度8.3vw（约40px），红色背景，白色文字
      - 内容："您的账户已被冻结"
      - 图标：警告图标

- 昵称管理：用户可在个人中心修改昵称，默认昵称为登录邮箱
  - 使用第三方库vee-validate实现表单验证
  - 验证规则：1-20个字符，不能包含特殊字符
  - 响应处理：更新成功后立即反映在UI上
  - UI设计：
    - 编辑界面：弹窗或新页面
    - 输入框：宽度100%，高度40px，圆角4px，边框1px
    - 验证提示：输入框下方红色文字提示
    - 确认/取消按钮：底部操作按钮组

- 管理员模块：
  - 审核功能入口：管理员在个人中心页面会看到"审核管理"入口，点击进入审核页面
  - 审核页面功能：
    - 查看待审核小说列表，支持批量选择
    - 点击小说标题查看详情和阅读预览
    - 支持单个审核操作（通过/拒绝）
    - 支持批量审核操作（批量通过/拒绝）
    - 显示待审核小说数量统计
    - 审核操作确认弹窗
  - 用户管理功能：可查看用户列表、冻结/解冻用户、删除冻结用户的未审核小说
  - 使用is_admin字段标识管理员账户
  - 审核操作响应处理：
    - 单个审核：操作完成后更新列表状态
    - 批量审核：显示操作结果统计（成功数量、失败数量、失败详情）

- 关于我们页面：
  - 在个人中心页面添加"关于我们"入口
  - 页面内容：
    - 项目介绍和愿景
    - 开发团队信息
    - 联系方式
    - 外部链接：推特(Twitter)、Telegram群组等社交媒体链接
    - 使用条款和隐私政策链接
    - 版本信息和更新日志
  - UI设计：
    - 标题区域：页面标题"关于我们"，居中显示，字体大小3.5vw（约16px）
    - 内容区域：白色背景卡片，圆角1.7vw（约8px），上下内边距4.2vw（约20px）
    - 项目介绍：段落形式，3.5vw字体（约16px），行高1.6
    - 团队信息：成员头像+姓名+职责
    - 社交链接：图标按钮，居中排列，图标尺寸5vw（约24px）
    - 版本信息：底部显示当前版本号，字体大小3vw（约14px）
    - 外部链接：可点击的链接样式

- 冻结用户处理：被冻结用户登录后，界面会显示账户被冻结提示，
  上传、评论、评分、点赞等功能将被禁用，但仍可浏览和阅读已有内容。
  - UI提示：在顶部显示横幅提示"您的账户已被冻结"
  - 功能禁用：上传按钮、评论输入框、评分组件等设置为禁用状态
  - UI设计：
    - 冻结提示横幅：全宽度，高度10.4vw（约50px），红色背景#f5222d
    - 文字：白色，3.3vw字体（约16px），居中显示
    - 图标：感叹号警告图标，尺寸4vw（约19px）
    - 可操作功能：置灰显示但不可点击
    - 功能解释：提示用户哪些功能受限

- 用户内容管理：用户可在个人中心查看和管理自己上传的小说、
  发布的评论、提交的评分
  - 上传小说管理：显示上传时间、状态、点击量、审核状态，提供删除功能
  - 评论管理：显示评论时间、评论内容、所属小说，提供删除功能
  - 评分管理：显示评分时间、评分值、评分说明、所属小说，提供删除功能
  - UI设计：
    - 列表样式：卡片式布局，白色背景，圆角8px
    - 每个条目：标题、副标题、操作按钮
    - 状态标签：不同状态用不同颜色区分（审核中-黄色，已通过-绿色，已拒绝-红色）
    - 操作按钮：删除按钮，红色，确认弹窗

- 系统消息：用户可在个人中心查看系统发送的通知消息，
  包括审核结果、账户状态变更等
  - 消息分类：通知、警告、信息
  - 消息状态：已读/未读
  - 功能：查看消息详情、标记为已读、批量标记为已读
  - UI设计：
    - 消息列表：卡片式布局，白色背景
    - 每条消息：
      - 左侧：消息类型图标（通知-铃铛，警告-感叹号，信息-i图标）
      - 中间：标题+摘要，未读消息标题加粗
      - 右侧：时间戳，未读状态有红色圆点
      - 底部：消息内容预览
    - 消息状态：未读消息标题主题色，已读消息标题灰色
    - 操作：可点击展开详情，右侧操作按钮
    - 批量操作：顶部选择框，支持批量标记已读/删除

#### 1.2 首页
- 顶部搜索框：按名称、作者、主角名称、小说字数等搜索小说
  - 搜索建议：输入时显示搜索建议列表
  - 搜索历史：保存最近搜索记录
  - 搜索按钮：执行搜索操作
- 推荐小说列表：展示推荐小说（名称、logo图片、作者、字数、评分）
- 无限滚动加载更多小说（使用第三方库vue-virtual-scroll-list实现）
- 调用后端接口查询推荐小说列表
  - UI设计：
    - 顶部搜索框
      - 位置：页面顶部，固定（sticky）
      - 高度：9.2vw（约44px）
      - 宽度：95%，左右边距2.5%
      - 内边距：1.7vw 3.3vw（约8px 16px）
      - 背景色：#ffffff（浅色模式）/ #1f1f1f（深色模式）
      - 边框：0.2vw solid #e0e0e0（约1px），圆角4.2vw（约20px）
      - 搜索图标：左侧3.3vw位置（约16px），尺寸3.3vw×3.3vw（约16px）
      - 输入框：高度6.25vw（约30px），边框无，背景透明
      - 搜索按钮：右侧，主题色背景，圆角0.8vw（约4px）
    - 小说卡片
      - 布局：水平卡片布局，支持左右滑动
      - 尺寸：宽度29vw（移动端）/ 30vw（桌面端），高度44vw（移动端）/ 50vw（桌面端）
      - 边距：左右各1.7vw（约8px），上下各2.1vw（约10px）
      - 背景色：#ffffff（浅色模式）/ #2d2d2d（深色模式）
      - 圆角：1.7vw（约8px）
      - 阴影：0 0.4vw 1.7vw rgba(0,0,0,0.1)（约0 2px 8px）
      - 封面图片：宽高比3:4，圆角1.3vw（约6px），高度占卡片60%
      - 标题：字体大小2.9vw（约14px）（移动端）/ 3.3vw（约16px）（桌面端），加粗，行高1.3
      - 作者：字体大小2.5vw（约12px），颜色#666666
      - 字数：字体大小2.3vw（约11px），颜色#999999
      - 评分：星级显示，字体大小2.5vw（约12px）
      - 点击效果：轻微缩放动画（0.95倍）
    - 响应式布局
      - 移动端：一排1-2个卡片，支持横向滚动
      - 平板端：一排2-3个卡片
      - 桌面端：一排3-4个卡片，网格布局
    - 加载状态：显示骨架屏或加载动画
      - 骨架屏：使用vue-content-loading，模拟卡片形状
      - 加载动画：居中显示旋转动画
    - 空状态：当没有推荐小说时显示友好提示
      - 图标：空状态插图
      - 文字：4.2vw字体（约20px），居中显示
      - 按钮：可选的操作按钮
    - 分类导航（可选）
      - 位置：搜索框下方
      - 高度：8.3vw（约40px）
      - 滚动：水平滚动，显示常用分类
      - 分类项：圆角按钮，主题色边框，内部边距2.1vw 3.3vw（约10px 16px）
    - 推荐标题栏
      - 位置：列表上方
      - 高度：6.25vw（约30px）
      - 文字：标题"推荐小说"，左对齐，3.3vw字体（约16px）
      - 更多链接：右侧"更多"链接，主题色
#### 1.3 分类页
- 分类列表：展示各种小说分类
- 默认显示第一个分类的小说列表（名称、logo图片、作者、字数）
- 分类切换：点击分类切换显示对应小说列表
- 无限滚动加载更多小说（使用第三方库vue-virtual-scroll-list实现）
- 调用后端接口查询分类小说列表
- UI设计：
  - 分类导航：水平滚动分类标签
  - 小说卡片：统一的卡片样式，显示标题、作者、字数、缩略图
  - 加载状态：显示骨架屏或加载动画
  - 空状态：当分类下没有小说时显示友好提示

#### 1.4 排行榜页
- 顶部时间范围选择：总榜、今日榜、本周榜、本月榜
- 排行榜列表：按点击量排序展示小说（排名、名称、logo图片、作者、点击量）
- 无限滚动加载更多小说（使用第三方库vue-virtual-scroll-list实现）
- 调用后端接口查询排行榜数据
- UI设计：
  - 排行榜项：显示排名序号、小说信息、点击量统计
  - 排名标识：前3名特殊标识（如奖杯图标）
  - 加载状态：显示骨架屏或加载动画
  - 空状态：当没有排行榜数据时显示友好提示

#### 1.5 上传页
- 上传功能：支持单个或批量上传txt、epub格式文件
  - 普通用户每日上传限制为10本，管理员用户不受限制
  - 上传失败时根据错误类型显示具体提示
  - 必须登录用户才能上传

  - 上传频率限制：
    - 每个用户每日上传小说数量限制为10本，按自然日（00:00-23:59）计算
    - 管理员用户不受此限制
    - 频次上传超过限制时提示"今日上传次数已达上限，请明天再试"

- 文件选择：拖拽上传或点击选择文件
- 文件hash验证：上传前计算文件hash防止重复上传（使用js-sha256库）
- 上传进度显示：批量上传时每上传一个进度条就前进，
  直到所有的都上传完成；如果是单个文件，进度条从0到100变化，
  上传成功后显示100的进度
- 审核状态：上传后小说处于审核中状态
- 小说列表：默认展示审核中和已通过的小说，
  上传列表返回上传用户的信息（包括昵称）
- 审核过滤：可选择是否过滤审核中的小说
- 无限滚动加载更多小说（使用第三方库vue-virtual-scroll-list实现）
- 上传状态反馈：成功、失败、处理中等状态显示
- 删除小说功能（上传用户和管理员可以删除）
- UI设计：
  - 上传区域：拖拽上传区域，清晰的上传指引
  - 文件列表：显示文件名、大小、格式、状态
  - 进度条：直观显示上传进度
  - 文件列表：分页显示上传的小说，包含标题、状态、上传时间、点击量等信息
  - 操作按钮：删除、预览等操作

#### 1.6 底部导航栏
- 首页：推荐小说展示
- 分类：小说分类浏览
- 排行榜：阅读次数排行榜
- 上传：上传txt、epub格式小说
- 用户：用户个人中心、注册登录入口（未登录显示登录注册，
  已登录显示个人中心）
  - UI设计：
    - 固定底部导航，适配移动端
      - 高度：10.4vw（相对于视口宽度，约50px）
      - 背景色：#ffffff（浅色模式）/ #1f1f1f（深色模式）
      - 边框：0.2vw solid #e0e0e0（约1px）
      - 定位：fixed，bottom: 0，left: 0，right: 0
      - z-index: 1000，确保始终在最顶层
    - 当前页面高亮显示
      - 激活状态：图标和文字颜色为#1890ff（主题色）
      - 非激活状态：图标和文字颜色为#999999
      - 文字大小：2.5vw（约12px）
    - 图标+文字组合显示
      - 图标尺寸：5vw×5vw（约24px）
      - 图标与文字间距：0.8vw（约4px）
      - 每个项目平均分配宽度
      - 支持点击反馈动画（点击时轻微缩放效果）
    - 桌面端适配：
      - 在桌面端可选择隐藏底部导航栏，使用侧边栏替代
      - 或保持底部导航栏，但适当增大图标和文字尺寸
#### 1.7 小说详情页
- 小说基本信息展示：标题、作者、主角、字数、简介
- 小说封面显示：使用默认封面或上传的封面图片
- 作者信息展示：上传用户的昵称
- 小说字数统计：显示具体字数
- 小说分类展示：显示所属分类
- 小说关键词展示：显示关键词标签
- 小说简介（部分展示）：显示简短简介
- 评分和评论统计：显示平均评分、评分数量、评论数量
- 章节目录（通过解析小说文件自动生成和上传时提供，
  用户可点击目录项跳转到对应章节，当前阅读位置高亮显示，
  使用epub.js等库实现）
- 快速开始阅读按钮（点击右侧区域进入第一页，
  当用户对当前小说的阅读进度低于10%时记录阅读次数，
  从服务器获取并恢复用户上次阅读进度）。
  阅读进度会自动同步到服务器，支持跨设备同步。
- 点击简介可打开详细简介弹窗（居中显示，可右上角关闭）
- 点击评论可打开评论列表弹窗（居中显示，可右上角关闭，
  支持滚动分页，默认每页显示5条评论，支持按点赞最多和最新排序，
  点赞最多为默认排序）
- 相关小说推荐：显示3本相关推荐小说
- 删除小说功能（仅上传用户和管理员可见）
- UI设计：
  - 详情卡片：统一的详情展示布局
  - 标签系统：分类、关键词标签样式
  - 统计信息：清晰的统计数据显示
  - 章节目录：可折叠的目录列表
  - 推荐区域：推荐小说卡片展示
  - 弹窗样式：统一的弹窗设计规范

#### 1.8 阅读页面
- 仿起点中文网的阅读界面
- 支持分页/滚动阅读模式切换（使用epub.js或类似阅读器库实现）
- 个性化设置（字体、背景、间距）

  - 个性化阅读设置：
    - 字体大小（范围[12-100px]，提供常用选项）
    - 字体类型（宋体、黑体、楷体、仿宋等标准Web字体）
    - 背景颜色（白、黑、灰、护眼绿等，提供预设主题）
    - 行间距（1.0-2.5倍，预设常用选项）
    - 阅读模式：
      - 滚动模式：连续滚动阅读，适合长篇内容
      - 翻页模式：模拟纸质书翻页效果
    - 夜间模式：
      - 手动切换：用户可手动开启/关闭夜间模式
      - 护眼模式：提供护眼主题
      - 记忆功能：记住用户当前使用的主题模式，
        在下次访问时自动应用
    - 阅读位置记忆：记住用户当前阅读位置，包括章节和页码

- 目录导航（通过解析小说文件自动生成和上传时提供，
  用户可点击目录项跳转到对应章节，当前阅读位置高亮显示）
- 上一章/下一章导航：清晰的章节导航按钮
- 点击阅读内容区域左侧30%实现上一页，点击右侧30%实现下页，
  支持覆盖翻页效果（使用第三方库实现翻页动画和流畅滚动）
- 阅读模式选择（滚动模式和翻页模式，通过第三方库实现）
- 在进入小说第一章（即开始阅读）时调用接口记录点击量
- 自动保存阅读进度到服务器（通过阅读进度接口），
  使用防抖机制，每30秒或翻页时更新一次

  - 阅读统计功能：
    - 记录阅读时长：
      - 统计规则：仅在页面可见且用户有交互时统计，
        暂停超过30秒则暂停计时
      - 实现方式：使用第三方库moment.js或dayjs计算阅读时间
      - 活跃度判断：结合鼠标移动、键盘输入等事件判断用户是否在阅读
      - 统计精度：精确到分钟

- 在小说最后一页显示分类和关键词设置功能（必须登录用户且
  阅读进度按照字数位置的百分比达到20%以上时显示）
- 显示当前已设置的分类和关键词，避免重复设置
- 提交分类和关键词到后端接口（需要用户认证）
- 通过第三方库判断当前是否是每一章的最后一页，
  在该页面可以对小说的这一章节进行评论
- 章节目录（通过解析小说文件自动生成和上传时提供，
  第三方库如epub.js或txt解析库支持，用户可点击目录项
  跳转到对应章节，当前阅读位置高亮显示）
- 章节评论弹窗显示这一章的评论分页数据(点赞最多排序展示)
- 用户可以在弹窗的最下方一个输入框输入提交评论
- 评论的分页机制也是向下滚动刷新（使用第三方库vue-virtual-scroll-list实现）
- 支持在弹窗中对评论进行评论，使用第三方库vue3-tree-chart
  实现一级回复功能，不支持多层级嵌套回复
- 每个用户对同一章节的评论数量限制为5条，评论内容通过
  前端基本验证后提交（使用第三方库vee-validate实现字符
  长度限制、内容过滤等验证，评论内容最多500字符）。
  使用DOMPurify库对用户输入进行XSS过滤

  - 解析失败处理：
    - 如果解析失败，系统会显示错误信息并提供原始文件下载链接
    - 解析失败的小说在阅读页面显示提示：
      "该小说文件解析失败，您可以选择下载原始文件"
    - 提供下载按钮供用户下载原始文件
    - 无法在在线阅读器中查看内容

  - 流式加载小说内容实现：
    - 使用自定义阅读器组件实现流式加载，无需下载完整文件
    - 通过HTTP Range Requests请求特定范围的内容块
    - 实现内容预加载机制，提前加载用户可能阅读的下一部分内容
    - 支持断点续传，网络中断后可从断点继续加载
    - 缓存已加载的内容块，避免重复请求

- UI设计：
  - 阅读区域
    - 布局：全屏设计，无边距
    - 背景色：
      - 白天模式：#f5f5f5（页面背景），#fefefe（内容背景）
      - 夜间模式：#000000（页面背景），#1a1a1a（内容背景）
      - 护眼模式：#f6f6e8（页面背景），#f6f6e8（内容背景）
    - 内容区域：
      - 宽度：移动端90%，桌面端70%
      - 居中对齐
      - 上下边距：12.5vw（移动端）/ 20.8vw（桌面端）（约60px/100px）
    - 文本样式：
      - 字体大小：4.2vw（移动端）/ 3.8vw（桌面端）默认（约16px/18px）
      - 字体族：优先使用系统字体，备用字体栈：'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif
      - 行高：1.6（移动端）/ 1.8（桌面端）
      - 字间距：0.1vw（约0.5px）
      - 颜色：#333333（白天模式），#cccccc（夜间模式）
      - 文本对齐：两端对齐
  - 设置面板（悬浮/侧边栏）
    - 移动端：从底部滑出的面板，高度40vh，背景半透明
    - 桌面端：右侧固定侧边栏，宽度30%，背景半透明
    - 内容：
      - 字体调整滑块：最小值2.5vw（12px），最大值6.7vw（32px）（移动端）/ 10vw（48px）（桌面端）
      - 字体类型选择：下拉菜单，提供宋体、黑体、楷体、仿宋选项
      - 主题切换：圆形按钮组，提供白天/夜间/护眼模式切换
      - 行间距选择：按钮组，提供1.2/1.5/1.8/2.0/2.5倍选项
      - 阅读模式：切换按钮，滚动/翻页模式
      - 亮度调节：滑块（仅移动端，需要权限）
    - 交互：平滑动画，点击外部区域关闭
  - 导航控件
    - 顶部工具栏：
      - 位置：固定顶部，高度10.4vw（约50px）
      - 背景：半透明，支持主题色
      - 左侧：返回按钮，尺寸9.2vw×9.2vw（约44px），居中图标
      - 中间：章节标题，居中，3.3vw字体（约16px）
      - 右侧：设置按钮，尺寸9.2vw×9.2vw（约44px），居中图标
      - 进度条：在标题下方，高度0.6vw（约3px），主题色填充
    - 底部工具栏：
      - 位置：固定底部，高度10.4vw（约50px）
      - 左侧：上一章按钮，图标+文字，尺寸9.2vw×9.2vw（约44px）
      - 中间：目录按钮，居中图标，尺寸9.2vw×9.2vw（约44px）
      - 右侧：下一章按钮，图标+文字，尺寸9.2vw×9.2vw（约44px）
    - 翻页区域提示：
      - 左右翻页区域边界提示：透明覆盖层，边缘2.1vw宽度（约10px）
      - 点击反馈：翻页时轻微动画效果
  - 目录面板（弹窗/侧边栏）
    - 移动端：全屏弹窗，支持滚动
    - 桌面端：左侧侧边栏，宽度30%
    - 内容：
      - 搜索框：章节搜索功能
      - 章节列表：支持分组显示，当前章节高亮
      - 章节项：高度9.2vw（约44px），左侧图标，中间章节名，右侧页码
      - 分组标题：区分不同卷或部分
    - 交互：滚动加载更多章节，点击跳转
  - 进度指示
    - 进度条：顶部工具栏下方，显示当前阅读进度百分比
    - 进度弹窗：点击进度条显示跳转到具体章节的界面
    - 跳转按钮：快速跳转到书签位置
  - 评论区域（弹窗）
    - 样式：模态弹窗，半透明背景，居中显示
    - 尺寸：宽度90%（移动端）/ 60%（桌面端，最大500px），最大高度70vh
    - 头部：标题"章节评论"，关闭按钮
    - 内容区：评论列表，支持滚动
    - 输入区：评论输入框，发布按钮
    - 交互：支持滑动关闭（移动端）
  - 章节标题
    - 位置：章节开头，居中显示
    - 样式：字体4.2vw（移动端）/ 5vw（桌面端）（约20px/24px），加粗，主题色
    - 上下边距：6.25vw（约30px）
  - 翻页动画
    - 翻页模式：使用CSS3 transform实现平滑翻页动画
    - 动画时长：300ms
    - 动画效果：模拟纸质书翻页效果
    - 过渡效果：淡入淡出
  - 响应式适配
    - 移动端：全屏沉浸式，工具栏滑动显示
    - 桌面端：支持侧边栏目录，工具栏固定或悬浮
    - 横屏模式：调整内容宽度，优化阅读体验
  - 交互区域提示
    - 左右翻页区域：视觉提示，如边缘阴影或透明覆盖层
    - 点击反馈：翻页时的轻微动画效果
    

### 2. 核心功能

#### 2.1 搜索功能
- 全局搜索框：位于首页顶部、分类页顶部、排行榜页顶部
  - 搜索输入框：支持输入小说标题、作者、主角名称、字数等
  - 搜索按钮：执行搜索操作
  - 搜索建议：输入时显示搜索建议列表（最多5条）
  - 搜索历史：保存最近搜索记录（最多20条）
  - 热门搜索：显示热门搜索关键词
- 搜索结果页面：
  - 搜索结果显示：按匹配度、点击量、评分综合排序
  - 搜索结果项：显示标题、作者、主角、字数、点击量、评分、上传用户
  - 分页功能：支持分页浏览搜索结果
  - 筛选功能：支持按分类、关键词、字数范围等筛选
- 搜索操作交互：
  - 响应式搜索：输入延迟300ms后触发搜索
  - 加载状态：搜索时显示加载动画
  - 空状态：无搜索结果时显示友好提示
  - 错误处理：网络错误时显示错误提示

  - 搜索增强功能：
    - 高级搜索：
      - 多条件组合搜索（使用第三方库fuse.js实现模糊搜索，
        匹配度阈值设定为0.6）
      - 搜索结果排序：按匹配度、点击量、评分综合排序
    - 搜索历史：
      - 保存用户搜索历史（最多保存20条记录）
    - 热门搜索：
      - 热门词来源：基于近期的搜索数据统计
      - 更新频率：每小时更新一次
      - 展示数量：最多展示10个热门关键词
    - 搜索建议：
      - 触发机制：用户输入时延迟300ms触发
      - 建议数量：最多显示5条建议
      - 数据来源：结合搜索历史和热门搜索提供智能建议

- UI设计：
  - 搜索框：圆角设计，带搜索图标
  - 搜索建议：下拉列表形式，支持键盘导航
  - 搜索历史：标签形式展示，支持清除
  - 搜索结果：卡片列表布局
  - 筛选面板：侧边栏或顶部筛选区域

#### 2.2 个性化设置
- 字体大小调整（范围[12-100px]）：提供滑块或预设选项
- 背景色/主题切换（白、黑、灰三种选项）：预设主题或自定义颜色
- 阅读设置持久化：设置保存到本地存储，跨会话保持
- UI设计：
  - 设置面板：模态框或侧边栏形式
  - 预览功能：实时预览设置效果
  - 重置按钮：恢复默认设置

#### 2.3 阅读进度管理
- 自动保存阅读进度到本地存储（使用第三方库
  pinia-plugin-persistedstate实现）
- 按照字数位置的百分比存储和展示进度
- 显示阅读百分比：进度条或百分比数字显示
- 跳转到上次阅读位置继续阅读：页面加载时自动定位
- 阅读时长统计：显示累计阅读时长
- UI设计：
  - 进度条：底部固定进度条
  - 进度百分比：标题栏显示百分比
  - 继续阅读按钮：在小说列表中显示

  - 跨设备同步机制：
    - 本地存储数据仅在当前设备和浏览器中有效
    - 服务器存储支持跨设备同步
    - 同步策略：当用户在多个设备上同时阅读时，
      以最新的阅读进度为准进行同步
    - 时间戳精度：使用毫秒级时间戳进行精确比较
    - 进度精度：百分比保留两位小数（如85.25%）
    - 同步失败时的处理：
      - 本地缓存进度：使用第三方库pinia-plugin-persistedstate
        进行本地缓存
      - 重试机制：使用第三方库axios实现重试机制

#### 2.4 本地缓存策略
- 小说内容本地缓存：缓存已阅读的小说内容，支持离线阅读
- 用户设置本地存储：保存个性化设置
- 阅读历史本地缓存：缓存阅读历史记录
- 离线内容缓存：缓存热门小说内容，支持离线浏览
- UI设计：
  - 缓存状态：显示缓存大小和缓存内容
  - 清除缓存：提供手动清除缓存功能

### 3. 社交功能

#### 3.1 评论系统
- 章节评论展示：在小说阅读页面和小说详情页面显示评论列表
  - 评论列表：显示评论内容、作者、时间、点赞数
  - 回复功能：支持对评论进行回复（一级回复）
  - 排序功能：按点赞数、时间排序
  - 分页功能：支持分页加载评论
  - 评论作者标识：显示评论作者昵称
- 发布评论（必须登录用户才能发布）
  - 评论输入框：支持文本输入，最多500字符
  - 发布按钮：提交评论
  - 输入验证：验证评论内容长度和格式
  - 发布限制：每个用户对同一章节的评论数量限制为5条
- 评论回复功能：支持对评论进行一级回复
  - 回复输入框：在评论下方显示回复输入框
  - 回复列表：在评论下方显示回复内容
- 评论点赞（必须登录用户才能点赞）
  - 点赞按钮：显示点赞图标和点赞数
  - 点赞状态：已点赞的评论显示高亮状态
- 评论排序（最新、最热）
  - 排序切换：提供排序方式切换按钮
  - 默认排序：按点赞数排序

      - 评论管理：
        - 评论排序：
          - 按时间排序：最新评论优先或最旧评论优先
          - 按点赞数排序：点赞数高的评论优先
        - 评论限制：
          - 同章节评论数：每个用户对同一章节的评论数量限制为5条
          - 评论长度：评论内容最多500字符
          - 评论频率：同一用户连续评论间隔不少于30秒
        - 评论互动：
          - 评论回复：支持对评论进行回复，形成评论线程
          - 评论点赞：用户可以对评论进行点赞，但不能重复点赞

  - 评论删除权限：
    - 普通用户：只能删除自己发布的评论
    - 管理员：可以删除任何用户的评论
    - 删除确认：删除前显示确认对话框
      - UI设计：
      - 评论卡片
        - 整体布局：白色背景卡片，圆角1.7vw（约8px），阴影效果
        - 内边距：3.3vw（约16px）
        - 外边距：0 0 2.5vw 0（约0 0 12px 0）
        - 用户信息区：
          - 用户头像：尺寸7.5vw×7.5vw（约36px），圆角50%，左浮动
          - 用户昵称：2.9vw字体（约14px），加粗，颜色#333
          - 时间戳：2.5vw字体（约12px），颜色#999，与昵称同行
          - 用户等级标识：在昵称后显示（如VIP、管理员标识）
        - 评论内容区：
          - 内容文字：2.9vw字体（约14px），行高1.6，颜色#333
          - 内容边距：5vw 0 0 9.2vw（约24px 0 0 44px）（为头像留出空间）
          - 支持文本格式化（粗体、斜体等基础格式）
        - 操作按钮区：
          - 点赞按钮：左浮动，图标+数字，未点赞#999，已点赞#ff6b6b
          - 回复按钮：左浮动，图标+数字
          - 删除按钮：仅评论作者和管理员可见，右浮动，2.5vw字体（约12px）
          - 更多操作：三点菜单，包含举报等功能
        - 交互效果：
          - 按钮悬停：轻微变色效果
          - 点赞动画：点赞时的心形动画
      - 回复层级
        - 主评论与回复区分：回复评论缩进显示，左侧有引导线
        - 回复显示：直接在主评论下方显示，不嵌套多层
        - 回复样式：较小字体（2.7vw，约13px），较浅颜色（#666）
        - 引用样式：回复时引用原文，使用较浅背景色
      - 操作按钮
        - 点赞按钮：心形图标，尺寸4.2vw（约20px），未点赞时灰色，点赞后红色
        - 点赞数：2.5vw字体（约12px），颜色与按钮图标一致
        - 回复按钮：回复图标，尺寸4.2vw（约20px），颜色#999
        - 按钮间距：3.3vw（约16px）
        - 按钮悬停效果：颜色加深
      - 用户标识
        - 头像：默认头像+用户上传头像
        - 昵称：支持颜色区分（普通用户、VIP用户、管理员）
        - 认证标识：认证用户显示认证图标
      - 输入框
        - 发布评论输入框：
          - 高度：16.7vw（约80px）
          - 边框：0.2vw solid #e0e0e0（约1px），圆角1.7vw（约8px）
          - 内边距：2.5vw（约12px）
          - 字体大小：2.9vw（约14px）
          - 占位符：灰色提示文字
          - 字符计数：右下角显示"已输入X/500字"
          - 发布按钮：输入框右侧，主题色背景，圆角0.8vw（约4px）
        - 回复输入框：
          - 高度：12.5vw（约60px）
          - 样式与发布框保持一致
          - 带有被回复者昵称的引用提示
          - 取消回复按钮：右侧取消按钮
      - 评论列表容器
        - 滚动容器：支持滚动加载更多
        - 加载状态：底部显示加载动画
        - 空状态：无评论时显示"暂无评论，快来发表第一个评论吧"
        - 排序切换栏：顶部显示排序选项（最新/最热）
      - 分页显示
        - 无限滚动：滚动到底部自动加载更多
        - 手动分页：可选的分页控件
        - 加载提示：显示"正在加载更多评论..."
      - 移动端适配
        - 输入框：自适应键盘弹起
        - 按钮大小：确保触摸区域不小于9.2vw（约44px）
        - 布局：单列显示，充分利用宽度
      - 桌面端适配
        - 输入框：可以更宽，支持更多功能
        - 按钮：可以显示文字标签
        - 布局：可以支持更多功能展示
#### 3.2 评分系统
- 为小说打分（必须登录用户才能评分）
  - 评分组件：5星评分组件
  - 评分说明：可选的评分说明输入框（最多250字符）
  - 提交按钮：提交评分
  - 防重复评分：已评分的小说显示当前评分
- 提交评分说明（对小说的评论）
  - 评分说明输入框：多行文本输入框
  - 字符计数：实时显示已输入字符数
  - 输入验证：验证输入内容长度和格式
- 查看平均评分
  - 平均评分显示：以星级和数值形式显示
  - 评分人数：显示评分人数
  - 评分分布：以图表形式显示各星级评分分布
- 查看小说评分列表（包含评分、评分说明、点赞数）
  - 评分列表：显示评分值、评分说明、作者、时间、点赞数
  - 分页功能：支持分页浏览评分
  - 排序功能：按时间、点赞数排序
- 对评分进行点赞（必须登录用户才能点赞）
  - 点赞按钮：显示点赞图标和点赞数
  - 点赞状态：已点赞的评分显示高亮状态
- 防重复评分机制：同一用户对同一小说只能评分一次
  - 评分显示：已评分的用户显示自己的评分
  - 评分修改：允许用户修改自己的评分
  - 评分锁定：评分后不能立即修改，需等待一段时间

  - 评分统计：
    - 实时计算平均分
    - 评分分布统计（各星级评分数量及占比）
    - 简单的异常评分检测：对短时间内大量评分进行基础检测

  - 评分删除权限：
    - 普通用户：只能删除自己发布的评分
    - 管理员：可以删除任何用户的评分
    - 删除确认：删除前显示确认对话框
  - UI设计：
    - 评分组件：直观的星级评分组件
    - 评分列表：评分项的统一展示样式
    - 评分分布：图表形式的评分分布展示
    - 操作按钮：点赞、删除等操作按钮

### 4. 数据管理

#### 4.1 API交互
- 与后端API通信（使用Axios库）
  - 请求拦截器：添加认证头、请求参数处理等
  - 响应拦截器：错误处理、数据转换、全局错误提示
  - 错误处理：统一处理API错误响应
  - 重试机制：网络异常时自动重试
- 文件上传功能（支持txt、epub格式）
  - 上传进度：实时显示上传进度
  - 文件验证：格式和大小验证
  - 上传状态：成功、失败、处理中状态显示
- 使用epub.js库处理EPUB格式文件
- 本地数据持久化（使用浏览器localStorage/sessionStorage或vuex-persist库）
- 用户认证状态管理（使用JWT token）
  - token自动刷新
  - 过期处理
  - 未授权跳转
- UI设计：
  - 加载状态：全局加载指示器
  - 错误提示：统一的错误提示组件
  - 成功提示：操作成功提示组件

#### 4.2 数据缓存策略
- API响应数据缓存（使用axios-cache-adapter或类似库）
  - 缓存时间：根据数据更新频率设置合适的缓存时间
  - 缓存失效：数据更新时清除相关缓存
- 小说内容缓存（针对流式加载的内容块）
  - 内容分块缓存：缓存已加载的小说内容块
  - 缓存清理：定期清理过期内容
- 推荐结果缓存（减少重复请求）
  - 推荐数据缓存：缓存推荐算法结果
  - 个性化推荐：基于用户行为的推荐缓存
- 搜索结果缓存（短期缓存热门搜索词结果）
  - 搜索历史缓存：本地缓存搜索历史
  - 热门搜索缓存：缓存热门搜索关键词
- UI设计：
  - 缓存状态：显示缓存大小和状态
  - 手动清理：提供手动清理缓存功能

### 5. 性能优化

#### 5.1 渲染优化
- 虚拟滚动（处理长文本，使用vue-virtual-scroller或vue-virtual-scroll-list库）
  - 无限滚动列表：小说列表、评论列表、评分列表
  - 内存管理：只渲染可见区域的元素
- 内容懒加载：小说内容分块加载
- 图片懒加载：小说封面、用户头像等图片
- 组件按需加载：路由级别的组件懒加载
- 小说内容流式加载（用户不需要下载小说全文本文件才可以阅读，而是传一些数据就可以阅读小说，实现更快的加载）
- 翻页内容预加载：预加载用户可能访问的下一页内容
- 点击区域事件优化：优化翻页响应速度
- EPUB内容渲染优化（使用epub.js库）
- UI设计：
  - 骨架屏：内容加载时显示骨架屏
  - 预加载指示：显示预加载状态

#### 5.2 网络优化
- API请求缓存：减少重复请求
- 请求合并：批量操作合并请求
- 数据压缩：使用Gzip压缩响应数据
- 请求去重：防止重复请求相同资源
- 预加载机制：对用户可能访问的资源进行预加载
- 延迟加载：对非关键资源采用延迟加载策略

#### 5.3 内存优化
- 内存泄漏防范：正确清理组件和事件监听器
- 组件销毁清理：组件销毁时清理定时器、事件监听器
- 定时器清理：及时清理不需要的定时器
- 大型数据结构优化：使用WeakMap、WeakSet等避免内存泄漏
- 图片资源优化：使用适当的图片格式和压缩
- 组件状态管理优化：避免不必要的状态更新
- UI设计：
  - 内存使用指示：显示内存使用情况（可选）
  - 清理提示：内存不足时的提示和处理

#### 5.4 错误边界和异常处理
- 全局错误处理组件：捕获未处理的JavaScript错误
- 网络请求错误处理：统一处理API请求失败
- 资源加载错误处理：图片、EPUB文件等资源加载失败
- 用户界面错误恢复：提供错误恢复机制
- 错误日志收集：收集错误信息用于分析
- UI设计：
  - 友好错误页面：显示错误信息并提供返回或重试选项
  - 错误提示：统一的错误提示样式和位置
  - 降级显示：在错误情况下显示基础内容

### 6. 用户体验

#### 6.1 响应式设计
- 适配桌面端、平板、手机
- 不同屏幕尺寸下的阅读体验优化
- 横屏/竖屏自适应
  - UI设计：
    - 移动端优化：针对小屏幕优化布局
      - 断点设置：最大宽度768px为移动端
      - 底部导航栏：固定底部，图标+文字，高度10.4vw（相对于视口宽度，约50px）
      - 搜索框：全宽度设计，高度8.3vw（约40px），圆角1.7vw（约8px）
      - 小说卡片：宽度95%，边距2.5%，图片比例3:4，高度20vh（视口高度的20%）
      - 阅读界面：全屏设计，字体大小4.2vw（约16px），行高1.6
      - 按钮尺寸：最小触摸区域9.2vw*9.2vw（约44px），确保易操作
    - 桌面端优化：充分利用大屏幕空间
      - 断点设置：最小宽度769px为桌面端
      - 侧边栏导航：固定左侧，宽度15%，可折叠
      - 搜索框：宽度20%，最小300px，居中或左对齐
      - 小说卡片：一行3-4个，图片高度25vh
      - 阅读界面：左右分栏设计，左侧目录占25%，右侧内容占75%
      - 按钮尺寸：适中设计，确保美观和可操作性
    - 平板适配：平衡移动端和桌面端体验
      - 断点设置：768px-1024px为平板
      - 导航设计：顶部导航+底部导航可选
      - 小说卡片：一行2-3个
      - 阅读界面：单列设计，但字体和间距可适当增大
    - 阅读界面适配：
      - 移动端：全屏沉浸式阅读，工具栏滑动显示
      - 桌面端：支持侧边栏目录，工具栏固定或悬浮
      - 字体大小：移动端基础4.2vw（约16px），桌面端基础3.8vw（约18px）
      - 行间距：移动端1.6，桌面端1.8
    - 交互优化：
      - 移动端：支持手势翻页，点击区域30%边距翻页
      - 桌面端：支持键盘翻页，鼠标滚轮翻页
      - 统一：阅读进度自动保存，跨设备同步
#### 6.2 交互体验
- 平滑滚动：页面和列表滚动动画
- 快速加载动画：骨架屏、进度条等
- 操作反馈：按钮点击、表单提交等反馈
- 错误处理和友好的错误提示
- 阅读页面点击翻页交互
- 阅读模式切换体验

  - 用户体验增强：
    - 页面加载：
      - 骨架屏或加载动画（使用第三方库vue-content-loading实现骨架屏）
      - 预加载热门小说内容以提升用户体验
      - 渐进式加载（使用第三方库vue-lazyload实现图片懒加载）
    - 操作反馈：
      - 成功/失败提示（使用第三方库element-plus的Notification组件）
      - 操作确认对话框（防止误操作）
      - 进度指示（上传、下载等长时间操作的进度显示）
    - 错误处理：
      - 友好的错误提示（使用第三方库vue-toastification显示错误信息）
      - 错误上报机制（使用第三方库sentry捕获并上报错误）
      - 网络异常处理（离线模式支持和重试机制）
    - 状态管理：
      - 加载状态（显示加载中的视觉反馈）
      - 空状态（当没有数据时显示友好提示）
      - 错误状态（当发生错误时提供重试或返回选项）
      - 离线状态（网络不可用时的界面提示和功能限制）
    - 交互细节：
      - 防抖处理（对频繁操作进行防抖处理，如搜索）
      - 节流处理（对滚动等事件进行节流处理）
      - 点击穿透防护（防止移动端点击穿透问题）
      - 状态同步（确保UI状态与数据状态保持一致）
    - UI设计：
      - 统一的加载动画
      - 友好的错误页面
      - 直观的操作反馈
      - 一致的状态指示

#### 6.3 无障碍访问
- 语义化HTML：使用适当的HTML标签
- 键盘导航支持：支持键盘操作
- 屏幕阅读器兼容：支持辅助技术
- 高对比度模式支持：支持高对比度主题
- UI设计：
  - 无障碍标签：为交互元素提供清晰的标签
  - 键盘焦点：清晰的键盘焦点指示
  - 对比度：确保足够的颜色对比度

### 7. 安全性

#### 7.1 XSS防护
- 用户输入内容过滤：使用DOMPurify库过滤评论、评分说明等用户输入
- 内容展示安全：对动态内容进行安全处理
- 响应数据验证：验证API响应数据的安全性
- 内容安全策略（CSP）：配置适当的CSP头防止XSS
- 内部链接验证：验证跳转链接的安全性

### 7.2 数据验证和输入过滤
- 前端表单验证：使用vee-validate进行表单验证
- 输入长度限制：限制用户输入的最大长度
- 特殊字符过滤：过滤或转义特殊字符
- 文件上传验证：验证上传文件类型和大小
- URL参数验证：验证URL参数的有效性
- API响应数据验证：验证服务器返回数据的结构和内容

#### 7.2 认证安全
- Token安全存储：使用httpOnly cookie或安全的localStorage存储
- 自动过期处理：token过期时自动跳转到登录页面
- 未授权访问：拦截未授权的API请求
- 会话管理：安全的会话创建和销毁

#### 7.3 错误处理和边界情况
- 网络异常处理：
  - 离线模式支持：检测网络状态并提供离线功能
  - 请求重试机制：网络失败时自动重试
  - 断网状态提示：网络断开时显示提示
  - 自动重连功能：网络恢复时自动重连
- 数据边界处理：
  - 空数据状态展示：显示友好的空状态页面
  - 加载失败状态处理：显示错误状态和重试选项
  - 数据格式验证：验证API响应数据格式
  - 字符串长度限制：前端验证输入长度
- 用户操作边界：
  - 频率限制提示：操作频率限制时的提示
  - 权限不足处理：权限不足时的友好提示
  - 操作冲突处理：避免并发操作冲突
  - 重复操作防护：防止重复提交
- UI边界情况：
  - 极端屏幕尺寸适配：适配极小和极大屏幕
  - 字体大小变化适应：适配系统字体大小变化
  - 网络延迟适应：网络延迟时的用户体验
  - 内存不足处理：内存不足时的降级处理
- UI设计：
  - 网络状态指示：显示当前网络状态
  - 错误页面：统一的错误页面设计
  - 重试按钮：在错误状态提供重试功能
  - 离线提示：明确的离线状态提示

### 8. 构建和部署

#### 8.1 构建配置
- Vite配置：优化构建配置，包括代码分割、压缩等
- 环境变量管理：区分开发、测试、生产环境配置
- 代码分割策略：按路由和功能进行代码分割
- 资源优化：图片、字体等资源的优化处理
- UI设计：
  - 构建进度：显示构建进度和状态
  - 错误日志：清晰的构建错误提示

#### 8.2 部署配置
- 静态文件部署：优化静态资源部署策略
- API接口配置：配置API基础URL
- CDN配置：静态资源CDN加速配置
- 缓存策略：浏览器缓存配置
- 安全头配置：配置安全相关的HTTP头
- UI设计考虑：
  - 部署状态：部署过程的状态指示
  - 版本信息：显示当前版本信息

## 第三方库使用

- Vue.js 3.x: 前端框架
- Vue Router: 路由管理
- Pinia: 状态管理
- Element Plus/Naive UI: UI组件库
- Axios: HTTP请求
- epub.js: EPUB格式处理
- js-sha256: 文件hash计算
- pinia-plugin-persistedstate: 本地存储持久化
- vee-validate: 表单验证

- moment.js或dayjs: 时间处理
- fuse.js: 模糊搜索
- vue3-tree-chart: 评论树形结构
- vue-content-loading: 骨架屏加载
- vue-lazyload: 图片懒加载
- vue-toastification: 错误提示
- vue-virtual-scroll-list: 无限滚动加载和虚拟滚动
- core-js: JavaScript兼容性
- normalize.css: CSS重置
- nprogress: 页面加载进度条
- crypto-js: 加密算法支持

## 组件设计

### 1. 基础组件
- 按钮组件：统一的按钮样式，支持不同尺寸、颜色、状态
  - UI设计：圆角设计，阴影效果，悬停状态变化
- 输入框组件：支持不同类型的输入（文本、密码、搜索等）
  - UI设计：清晰的边框，焦点状态，错误状态
- 卡片组件：通用的内容展示卡片
  - UI设计：圆角边框，阴影效果，响应式布局
- 弹窗组件：模态框、对话框等弹窗组件
  - UI设计：半透明遮罩，居中定位，动画效果
- 加载组件：加载动画、骨架屏等
  - UI设计：旋转动画，骨架屏样式
- 分页组件：支持分页导航
  - UI设计：页码按钮，当前页高亮
- 标签组件：分类标签、关键词标签等
  - UI设计：圆角标签，不同颜色主题
- 图标组件：统一的图标库集成
  - UI设计：一致的图标风格和大小

### 2. 业务组件
- 小说卡片组件：展示小说基本信息
  - 包含：标题、作者、字数、评分、缩略图、点击量
  - UI设计：统一的卡片样式，悬停效果，响应式布局
- 阅读器组件（支持txt和epub格式，使用epub.js等第三方库实现）
  - 功能：字体调整、主题切换、翻页、书签等
  - UI设计：沉浸式阅读界面，工具栏悬浮显示
- 目录组件（使用第三方库实现章节导航）
  - 功能：章节列表、当前章节高亮、跳转功能
  - UI设计：可折叠侧边栏，清晰的层级结构
- 评论组件（使用第三方库实现评论功能）
  - 功能：评论列表、发布评论、回复评论、点赞评论
  - UI设计：评论树形结构，用户信息展示，操作按钮
- 评分组件（支持评分、评分说明输入）
  - 功能：星级评分、评分说明、提交功能
  - UI设计：星级图标，评分说明输入框
- 评分列表组件（展示评分、评分说明、点赞数）
  - 功能：评分列表、排序、分页
  - UI设计：评分项卡片，用户信息，点赞按钮
- 评分点赞组件（对评分进行点赞）
  - 功能：点赞/取消点赞、点赞数显示
  - UI设计：点赞图标，数字显示
- 搜索组件
  - 功能：搜索输入、搜索建议、搜索历史、热门搜索
  - UI设计：搜索框、下拉建议列表、历史记录标签
- 翻页组件（支持点击翻页和滚动翻页，使用第三方库实现）
  - 功能：上下页导航、目录跳转、页码显示
  - UI设计：清晰的导航按钮，页码指示
- 文件上传组件（支持txt、epub格式，使用第三方库实现）
  - 功能：拖拽上传、文件选择、进度显示、格式验证
  - UI设计：拖拽区域，文件列表，进度条
- 无限滚动组件（实现滚动加载更多功能，使用第三方库）
  - 功能：滚动触发加载、加载状态、分页管理
  - UI设计：加载指示器，分页提示
- 底部导航栏组件
  - 功能：页面导航、当前页面指示
  - UI设计：固定底部，图标+文字，当前页高亮
- 排行榜组件
  - 功能：排行榜显示、时间范围切换、排序
  - UI设计：排名序号，小说信息，点击量显示
- 分类选择组件（用于为小说选择分类）
  - 功能：分类选择、多选支持
  - UI设计：分类标签，选择状态指示
- 关键词输入组件（用于为小说添加关键词）
  - 功能：关键词输入、标签化显示、删除
  - UI设计：输入框+标签列表，关键词样式
- 小说分类设置组件（显示当前分类和关键词，允许用户设置）
  - 功能：分类选择、关键词编辑、提交保存
  - UI设计：分类下拉，关键词标签编辑器
- 进度条组件（显示上传进度，使用第三方库实现）
  - 功能：进度显示、状态指示
  - UI设计：彩色进度条，百分比显示
- 本地存储组件（管理阅读进度等本地数据，使用浏览器API或vuex-persist）
  - 功能：数据存储、读取、清除
  - UI设计：存储状态显示，清理按钮
- 用户注册组件（邮箱注册表单，使用第三方库vee-validate验证）
  - 功能：邮箱验证、密码验证、注册提交
  - UI设计：表单布局，验证错误提示
- 用户登录组件（邮箱登录表单，使用第三方库vee-validate验证）
  - 功能：邮箱验证、密码验证、登录提交、记住我
  - UI设计：表单布局，错误提示，社交登录选项
- 个人中心组件（展示用户信息和操作历史）
  - 功能：用户信息展示、历史记录、设置选项
  - UI设计：用户卡片，功能入口列表
- 用户认证组件（管理JWT token和用户状态）
  - 功能：登录状态管理、token刷新
  - UI设计：状态指示，认证相关界面
- 阅读进度组件（管理用户阅读进度，自动保存到服务器）
  - 功能：进度保存、进度恢复、进度显示
  - UI设计：进度条，百分比显示
- 阅读历史组件（展示用户阅读历史记录）
  - 功能：历史列表、删除记录、继续阅读
  - UI设计：历史项卡片，时间戳，进度指示
- 用户内容管理组件（管理用户上传的小说、发布的评论、提交的评分）
  - 功能：内容列表、编辑、删除、状态管理
  - UI设计：内容卡片，操作按钮，状态标签
- 小说管理组件（管理用户上传的小说，包括编辑、删除功能）
  - 功能：小说列表、状态管理、编辑、删除
  - UI设计：小说卡片，操作按钮，状态指示
- 评论管理组件（管理用户发布的评论，包括编辑、删除功能）
  - 功能：评论列表、编辑、删除、回复管理
  - UI设计：评论卡片，操作按钮，层级显示
- 评分管理组件（管理用户提交的评分，包括编辑、删除功能）
  - 功能：评分列表、编辑、删除、评分修改
  - UI设计：评分卡片，星级显示，操作按钮
- 管理员用户管理组件（管理员查看和管理用户，包括冻结/解冻功能）
  - 功能：用户列表、冻结/解冻、删除用户
  - UI设计：用户卡片，状态指示，操作按钮
- 管理员内容管理组件（管理员管理用户内容，包括一键删除未审核小说功能）
  - 功能：内容列表、审核、删除、批量操作
  - UI设计：内容卡片，状态指示，批量操作工具栏
- 管理员审核组件：
  - 审核列表组件：显示待审核小说列表，支持批量选择
    - 功能：小说列表、选择、筛选、排序
    - UI设计：审核项卡片，选择复选框，状态标签
  - 审核详情组件：显示小说详情和预览功能
    - 功能：详情展示、内容预览、审核操作
    - UI设计：详情面板，预览区域，操作按钮
  - 审核操作组件：单个审核操作（通过/拒绝）
    - 功能：审核决策、原因输入、提交
    - UI设计：操作按钮，原因输入框
  - 批量审核组件：批量操作工具栏和确认对话框
    - 功能：批量选择、批量操作、确认对话框
    - UI设计：批量操作工具栏，确认弹窗
  - 审核统计组件：显示待审核数量统计
    - 功能：统计信息展示、实时更新
    - UI设计：统计卡片，数字显示
- 系统消息组件（展示系统消息，包括审核结果、账户状态变更等通知）
  - 功能：消息列表、标记已读、删除消息
  - UI设计：消息卡片，状态指示，操作按钮
- 关于我们组件：
  - 项目介绍展示组件
    - 功能：项目信息展示、团队介绍
    - UI设计：信息卡片，分段展示
  - 社交媒体链接组件（推特、Telegram等）
    - 功能：社交媒体链接、外部跳转
    - UI设计：图标链接，统一风格
  - 法律信息组件（使用条款、隐私政策）
    - 功能：法律文档展示、外部链接
    - UI设计：文档卡片，链接样式
  - 版本信息组件（版本号、更新日志）
    - 功能：版本信息展示、更新日志
    - UI设计：版本卡片，日志列表

### 3. 布局组件
- 头部导航：包含搜索框、用户信息、导航链接
  - UI设计：固定顶部，响应式布局，清晰导航
- 侧边栏：分类导航、功能入口
  - UI设计：可折叠侧边栏，图标+文字，分组导航
- 页脚：版权信息、链接
  - UI设计：固定底部，简洁信息，相关链接
- 响应式布局：适配不同屏幕尺寸
  - UI设计：断点适配，流式布局，弹性组件
- 主内容区域：页面主要内容展示区域
  - UI设计：居中布局，合适宽度，清晰边距

## API接口约定

### 1. 请求规范
- 使用Axios进行HTTP请求
- 统一的请求头设置
  - Content-Type: application/json
  - Authorization: Bearer {token} (认证请求)
- Token自动添加：通过请求拦截器自动添加认证头
- 请求超时设置：10秒
- 基础URL配置：通过环境变量配置API基础URL
- 请求参数处理：GET请求参数序列化，POST请求数据格式化
- UI交互：
  - 加载状态：请求发送时显示全局加载指示器
  - 错误处理：请求失败时显示错误提示

### 2. 响应处理
- 统一的响应格式处理
  - 成功响应：{ code: 200, data: {}, message: "success" }
  - 错误响应：{ code: 错误码, message: "错误信息" }
- 错误码定义：
  - 200: 成功
  - 400: 请求参数错误
  - 401: 未授权
  - 403: 禁止访问
  - 404: 资源不存在
  - 500: 服务器错误
- 加载状态管理：请求过程中的状态指示
- 分页数据结构：{ data: [], total: 0, page: 1, limit: 20 }
- UI交互：
  - 成功提示：操作成功时显示成功提示
  - 错误提示：错误响应时显示错误信息
  - 加载指示：请求过程中显示加载状态

### 3. 拦截器
- 请求拦截器（添加认证头、请求参数处理等）
  - 功能：自动添加token、请求参数预处理、加载状态管理
  - UI交互：开始请求时显示加载指示器
- 响应拦截器（错误处理、数据转换、全局错误提示）
  - 功能：错误处理、数据转换、全局错误提示、token过期处理
  - UI交互：错误时显示错误提示，token过期时跳转登录

### 4. 错误处理机制
- 统一错误响应格式处理
  - 成功响应：{ code: 200, data: {}, message: "success" }
  - 错误响应：{ code: 错误码, message: "错误信息", timestamp: "时间戳" }
  - 错误码定义：
    - 200: 成功
    - 400: 请求参数错误
    - 401: 未授权
    - 403: 禁止访问
    - 404: 资源不存在
    - 500: 服务器错误
    - 业务错误码：根据具体业务需求定义
- 用户友好的错误提示（使用第三方库vue-toastification显示错误信息）
- 网络异常处理（离线模式支持和重试机制）
- 请求重试机制（使用第三方库axios实现重试机制）
  - 重试条件：网络超时、服务器临时错误（5xx）、网络中断
  - 重试次数：默认3次
  - 重试间隔：指数退避算法（1s, 2s, 4s）
  - 重试限制：避免无限重试，设置最大重试时间
- 错误边界组件：捕获组件渲染错误
- 错误上报机制（使用第三方库sentry捕获并上报错误）
- 降级策略（当API不可用时提供缓存数据或默认内容）
- 断网处理（提供离线提示和重连机制）
- 业务错误处理：根据错误码执行相应的处理策略
- UI交互：
  - 错误提示：统一的错误提示样式
  - 重试按钮：错误时提供重试选项
  - 离线提示：网络断开时显示离线状态
  - 错误页面：特定错误码显示专门的错误页面

### 5. API响应数据结构（用于前端展示）
- 所有API响应遵循统一的格式，便于前端处理和展示

#### 5.1 用户相关接口返回数据
- 用户注册/登录响应：
  ```json
  {
    "code": 200,
    "data": {
      "user": {
        "id": 1,
        "email": "user@example.com",
        "nickname": "用户名",
        "is_active": true,
        "is_admin": false,
        "last_login_at": "2023-01-01T10:00:00Z"
      },
      "token": "jwt_token_here"
    },
    "message": "success"
  }
  ```
  - UI处理：登录成功后保存token，跳转到首页

- 用户信息响应：
  ```json
  {
    "code": 200,
    "data": {
      "id": 1,
      "email": "user@example.com",
      "nickname": "用户名",
      "is_active": true,
      "is_admin": false,
      "last_login_at": "2023-01-01T10:00:00Z",
      "created_at": "2023-01-01T10:00:00Z",
      "updated_at": "2023-01-01T10:00:00Z"
    },
    "message": "success"
  }
  ```
  - UI处理：更新用户信息展示

#### 5.2 小说列表接口返回数据
- 小说列表响应：
  ```json
  {
    "code": 200,
    "data": {
      "data": [
        {
          "id": 1,
          "title": "小说标题",
          "author": "作者名",
          "protagonist": "主角名",
          "description": "小说简介",
          "file_path": "/uploads/approved/novel1.epub",
          "file_size": 1024000,
          "word_count": 150000,
          "click_count": 1200,
          "today_clicks": 50,
          "week_clicks": 300,
          "month_clicks": 800,
          "upload_time": "2023-01-01T10:00:00Z",
          "last_read_time": "2023-01-01T10:00:00Z",
          "status": "approved",
          "file_hash": "hash_value",
          "upload_user": {
            "id": 2,
            "nickname": "上传者昵称"
          },
          "categories": [
            {
              "id": 1,
              "name": "玄幻"
            }
          ],
          "keywords": [
            {
              "id": 1,
              "keyword": "热血"
            }
          ]
        }
      ],
      "total": 100,
      "page": 1,
      "limit": 20
    },
    "message": "success"
  }
  ```
  - UI处理：渲染小说卡片列表，更新分页信息

#### 5.3 小说详情接口返回数据
- 小说详情响应：
  ```json
  {
    "code": 200,
    "data": {
      "id": 1,
      "title": "小说标题",
      "author": "作者名",
      "protagonist": "主角名",
      "description": "详细的小说简介",
      "file_path": "/uploads/approved/novel1.epub",
      "file_size": 1024000,
      "word_count": 150000,
      "click_count": 1200,
      "today_clicks": 50,
      "week_clicks": 300,
      "month_clicks": 800,
      "upload_time": "2023-01-01T10:00:00Z",
      "last_read_time": "2023-01-01T10:00:00Z",
      "status": "approved",
      "file_hash": "hash_value",
      "upload_user": {
        "id": 2,
        "email": "uploader@example.com",
        "nickname": "上传者昵称"
      },
      "categories": [
        {
          "id": 1,
          "name": "玄幻"
        }
      ],
      "keywords": [
        {
          "id": 1,
          "keyword": "热血"
        }
      ],
      "average_rating": 4.5,
      "rating_count": 120,
      "comment_count": 50,
      "user_progress": 25.5,
      "user_has_rated": false,
      "user_has_liked": false,
      "chapter_list": [
        {
          "id": 1,
          "title": "第一章 标题",
          "word_count": 3000
        }
      ],
      "recommendations": [
        {
          "id": 2,
          "title": "推荐小说标题",
          "author": "作者名",
          "click_count": 500
        }
      ]
    },
    "message": "success"
  }
  ```
  - UI处理：渲染小说详情页，显示相关信息和统计数据

#### 5.4 评论列表接口返回数据
- 评论列表响应：
  ```json
  {
    "code": 200,
    "data": {
      "data": [
        {
          "id": 1,
          "user": {
            "id": 2,
            "nickname": "评论者昵称"
          },
          "content": "评论内容",
          "like_count": 5,
          "created_at": "2023-01-01T10:00:00Z",
          "user_has_liked": false,
          "parent_id": null,
          "replies": [
            {
              "id": 2,
              "user": {
                "id": 3,
                "nickname": "回复者昵称"
              },
              "content": "回复内容",
              "like_count": 2,
              "created_at": "2023-01-01T11:00:00Z",
              "user_has_liked": false
            }
          ]
        }
      ],
      "total": 50,
      "page": 1,
      "limit": 5
    },
    "message": "success"
  }
  ```
  - UI处理：渲染评论列表，支持层级显示

#### 5.5 评分列表接口返回数据
- 评分列表响应：
  ```json
  {
    "code": 200,
    "data": {
      "data": [
        {
          "id": 1,
          "user": {
            "id": 2,
            "nickname": "评分者昵称"
          },
          "rating": 5,
          "review": "评分说明内容",
          "like_count": 3,
          "created_at": "2023-01-01T10:00:00Z",
          "user_has_liked": false
        }
      ],
      "total": 20,
      "page": 1,
      "limit": 20,
      "average_rating": 4.5,
      "rating_distribution": {
        "5": 8,
        "4": 6,
        "3": 4,
        "2": 1,
        "1": 1
      }
    },
    "message": "success"
  }
  ```
  - UI处理：渲染评分列表，显示评分分布图表

#### 5.6 分类列表接口返回数据
- 分类列表响应：
  ```json
  {
    "code": 200,
    "data": [
      {
        "id": 1,
        "name": "玄幻",
        "description": "玄幻小说分类",
        "novel_count": 150,
        "created_at": "2023-01-01T10:00:00Z",
        "updated_at": "2023-01-01T10:00:00Z"
      }
    ],
    "message": "success"
  }
  ```
  - UI处理：渲染分类列表，显示分类统计数据

#### 5.7 排行榜接口返回数据
- 排行榜响应：
  ```json
  {
    "code": 200,
    "data": {
      "data": [
        {
          "id": 1,
          "title": "小说标题",
          "author": "作者名",
          "click_count": 1200,
          "today_clicks": 50,
          "week_clicks": 300,
          "month_clicks": 800,
          "upload_user": {
            "id": 2,
            "nickname": "上传者昵称"
          }
        }
      ],
      "total": 100,
      "page": 1,
      "limit": 20
    },
    "message": "success"
  }
  ```
  - UI处理：渲染排行榜，显示排名信息

#### 5.8 搜索接口返回数据
- 搜索响应：
  ```json
  {
    "code": 200,
    "data": {
      "data": [
        {
          "id": 1,
          "title": "搜索结果小说标题",
          "author": "作者名",
          "protagonist": "主角名",
          "description": "小说简介",
          "word_count": 150000,
          "click_count": 1200,
          "upload_user": {
            "id": 2,
            "nickname": "上传者昵称"
          },
          "categories": [
            {
              "id": 1,
              "name": "玄幻"
            }
          ],
          "keywords": [
            {
              "id": 1,
              "keyword": "热血"
            }
          ],
          "average_rating": 4.5,
          "rating_count": 120
        }
      ],
      "total": 50,
      "page": 1,
      "limit": 20
    },
    "message": "success"
  }
  ```
  - UI处理：渲染搜索结果列表

#### 5.10 推荐接口返回数据
- 推荐列表响应：
  ```json
  {
    "code": 200,
    "data": [
      {
        "id": 1,
        "title": "推荐小说标题",
        "author": "作者名",
        "click_count": 1200,
        "average_rating": 4.5,
        "upload_user": {
          "id": 2,
          "nickname": "上传者昵称"
        }
      }
    ],
    "message": "success"
  }
  ```
  - UI处理：渲染推荐小说列表

#### 5.11 阅读进度接口返回数据
- 阅读进度响应：
  ```json
  {
    "code": 200,
    "data": {
      "progress": 25.5,
      "chapter_id": 3,
      "position": 1500,
      "updated_at": "2023-01-01T10:00:00Z"
    },
    "message": "success"
  }
  ```
  - UI处理：更新阅读进度显示

#### 5.12 阅读历史接口返回数据
- 阅读历史响应：
  ```json
  {
    "code": 200,
    "data": {
      "data": [
        {
          "id": 1,
          "novel": {
            "id": 1,
            "title": "小说标题",
            "author": "作者名",
            "description": "简介",
            "word_count": 150000
          },
          "progress": 25.5,
          "last_read_at": "2023-01-01T10:00:00Z",
          "status": "in_progress"
        }
      ],
      "total": 20,
      "page": 1,
      "limit": 20
    },
    "message": "success"
  }
  ```
  - UI处理：渲染阅读历史列表

### 6. API响应数据结构
- 小说详情响应应包含字数统计字段，用于前端展示
- 阅读页面需要支持翻页操作的API调用
- 上传接口支持文件和文件名一起上传
- 推荐接口：支持获取推荐小说列表，包括基于内容、热门、新书、个性化推荐
- 搜索接口：支持多条件组合搜索和高级搜索功能

### 7. 第三方库集成
- 集成EPUB处理库（如epub.js）来处理epub格式
- 集成虚拟滚动库（如vue-virtual-scroll-list）优化长文本渲染
- 集成无限滚动库（如vue-infinite-loading）实现滚动加载更多功能
- 集成本地存储库（如vuex-persist）管理用户个性化设置
- 集成文件上传库（如vue-upload-component）处理文件上传
- 集成分页库处理无限滚动和分页请求
- 集成防抖和节流库优化性能（如lodash的debounce/throttle）

### 8. 特殊功能API
- 记录小说点击量：在进入小说第一章（即开始阅读）时调用后端接口记录点击量
- 排行榜接口：支持按时间范围查询排行榜数据
- 搜索接口：支持按名称、作者、主角名称、小说字数等条件搜索
- 评分接口：支持提交评分和评分说明（最多250个字符，非必填）
- 小说内容流式加载接口：支持流式加载小说内容，用户不需要下载小说全文本文件才可以阅读，而是传一些数据就可以阅读小说，实现更快的加载
- 评分列表接口：获取小说的评分列表（包含评分、评分说明、点赞数、用户信息如昵称）
- 评分点赞接口：对指定评分进行点赞（需要用户登录）
- 小说分类和关键词接口：提交小说的分类和关键词（需要用户登录且阅读进度达到20%以上）
- 搜索接口扩展：支持按分类ID和关键词搜索小说
- 章节评论接口：获取和提交小说章节评论，支持对评论进行评论
- 点击量统计接口：支持小说点击量统计和排行榜数据获取
- 推荐系统接口：获取各类推荐小说列表（基于内容、热门、新书、个性化推荐）
- 推荐系统性能要求：
  - 推荐生成时间：个性化推荐计算时间不超过2秒
  - 推荐接口响应时间：推荐API响应时间不超过500毫秒
  - 缓存命中率：推荐结果缓存命中率不低于95%
  - 系统可用性：推荐系统可用性不低于99.5%
  - 前端实现：实现防抖机制减少不必要的推荐请求，实现推荐内容的懒加载，采用虚拟滚动优化大量推荐内容的渲染性能，推荐内容预加载以提升用户体验
- 点赞状态管理：点赞状态通过用户ID关联服务器数据
- 用户注册登录接口：支持邮箱注册和登录
- 用户信息管理接口：支持获取和更新用户信息（如昵称）
- 小说上传接口：必须登录用户才能上传小说
- 上传小说列表接口：返回上传用户的信息（包括昵称）
- 阅读进度接口：支持保存和获取用户阅读进度
- 用户阅读历史接口：获取用户的阅读历史记录
- 用户内容管理接口：支持获取和管理用户上传的小说、评论、评分
- 小说删除接口：支持删除小说（上传用户和管理员）
- 评论删除接口：支持删除评论（评论发布用户）
- 评分删除接口：支持删除评分（评分发布用户）
- 管理员用户管理接口：支持获取用户列表、冻结/解冻用户
- 管理员内容管理接口：支持删除冻结用户的未审核小说
- 批量审核接口：支持管理员批量审核小说（批量通过、批量拒绝）
- 系统消息接口：支持获取和管理用户系统消息
- 审核通知接口：当小说审核状态变更时通知上传用户
- 搜索统计接口：记录用户搜索行为，支持热门搜索词统计
- 获取热门搜索词接口：支持获取热门搜索词列表，用于前端展示

### 9. 数据缓存策略
- API响应数据缓存（使用axios-cache-adapter或类似库）
- 小说内容缓存（针对流式加载的内容块）
- 推荐结果缓存（减少重复请求）
- 搜索结果缓存（短期缓存热门搜索词结果）

### 10. 请求优化
- API请求合并（批量操作）
- 接口请求去重（防止重复请求相同资源）
- 预加载机制（对用户可能访问的资源进行预加载）
- 延迟加载（对非关键资源采用延迟加载策略）
- UI交互：
  - 缓存状态：显示缓存使用情况
  - 预加载指示：显示预加载状态
  - 离线缓存：支持离线数据访问

## 状态管理设计

### 1. 状态管理架构
- 使用Pinia作为状态管理库
- 模块化设计：按功能模块划分store
- 响应式状态：使用Vue 3的响应式系统
- 类型安全：使用TypeScript确保类型安全
- 持久化：关键状态数据持久化到本地存储
- UI设计考虑：
  - 状态变化可视化：开发环境下可查看状态变化
  - 错误状态管理：统一的状态错误处理

### 2. Store模块划分

#### 2.1 用户模块 (userStore)
- 状态：
  - `userInfo`: 用户信息（id, email, nickname, is_admin, is_active等）
  - `token`: JWT认证token
  - `isAuthenticated`: 认证状态
  - `loginError`: 登录错误信息
  - `registerError`: 注册错误信息
- 操作：
  - `login(email, password)`: 用户登录
  - `logout()`: 用户登出
  - `register(email, password, nickname)`: 用户注册
  - `updateProfile(nickname)`: 更新用户信息
  - `checkAuth()`: 检查认证状态
- Getter：
  - `isAdmin`: 是否为管理员
  - `isActive`: 用户是否活跃（未被冻结）
  - `userNickname`: 获取用户昵称（优先使用昵称，否则使用邮箱）
- UI交互：
  - 登录状态同步：在所有需要认证的页面同步显示登录状态
  - 用户信息更新：用户信息变更时即时更新UI

#### 2.2 小说模块 (novelStore)
- 状态：
  - `novelList`: 小说列表数据
  - `currentNovel`: 当前查看的小说详情
  - `pagination`: 分页信息（当前页、总页数、每页数量）
  - `loading`: 加载状态
  - `error`: 错误信息
- 操作：
  - `fetchNovels(params)`: 获取小说列表
  - `fetchNovelById(id)`: 根据ID获取小说详情
  - `searchNovels(keyword, filters)`: 搜索小说
  - `uploadNovel(file, metadata)`: 上传小说
  - `deleteNovel(id)`: 删除小说
- Getter：
  - `filteredNovels`: 过滤后的小说列表
  - `novelCount`: 小说总数
  - `hasMore`: 是否还有更多数据可加载
- UI交互：
  - 加载状态：显示加载动画和骨架屏
  - 错误处理：显示错误信息和重试选项
  - 分页控制：分页组件与状态同步

#### 2.3 阅读模块 (readingStore)
- 状态：
  - `readingProgress`: 阅读进度映射（novelId -> progress）
  - `readingHistory`: 阅读历史记录
  - `readingSettings`: 阅读设置（字体、主题、间距等）
  - `currentReading`: 当前正在阅读的小说信息
- 操作：
  - `saveProgress(novelId, progress, chapterId)`: 保存阅读进度
  - `getProgress(novelId)`: 获取阅读进度
  - `updateSettings(settings)`: 更新阅读设置
  - `addToHistory(novel)`: 添加到阅读历史
  - `clearHistory()`: 清空阅读历史
- Getter：
  - `recentHistory`: 最近阅读记录
  - `readingStats`: 阅读统计信息
  - `currentSettings`: 当前阅读设置
- UI交互：
  - 进度同步：阅读进度实时同步到UI
  - 设置应用：设置变更即时应用到阅读界面
  - 历史记录：阅读历史在多个页面间同步

#### 2.4 UI模块 (uiStore)
- 状态：
  - `theme`: 当前主题（light/dark）
  - `sidebarCollapsed`: 侧边栏是否折叠
  - `loading`: 全局加载状态
  - `notifications`: 通知消息列表
  - `modal`: 当前打开的弹窗
  - `screenSize`: 当前屏幕尺寸（用于响应式设计）
  - `networkStatus`: 网络连接状态
- 操作：
  - `toggleTheme()`: 切换主题
  - `toggleSidebar()`: 切换侧边栏
  - `showLoading()`: 显示加载状态
  - `hideLoading()`: 隐藏加载状态
  - `addNotification(message, type)`: 添加通知
  - `removeNotification(id)`: 移除通知
  - `openModal(component, props)`: 打开弹窗
  - `closeModal()`: 关闭弹窗
  - `updateScreenSize()`: 更新屏幕尺寸状态
  - `updateNetworkStatus(status)`: 更新网络状态
- Getter：
  - `isMobile`: 是否为移动端
  - `isTablet`: 是否为平板端
  - `isDesktop`: 是否为桌面端
- UI交互：
  - 主题切换：主题变更即时应用到整个应用
  - 通知系统：统一的通知显示和管理
  - 弹窗管理：弹窗状态与UI组件同步

#### 2.5 分类模块 (categoryStore)
- 状态：
  - `categories`: 分类列表
  - `currentCategory`: 当前选中的分类
  - `categoryNovels`: 当前分类下的小说列表
- 操作：
  - `fetchCategories()`: 获取分类列表
  - `selectCategory(id)`: 选择分类
  - `fetchNovelsByCategory(id, params)`: 获取分类下的小说
- Getter：
  - `categoryOptions`: 分类选项（用于下拉选择）
  - `categoryCount`: 分类数量
- UI交互：
  - 分类选择：分类变更同步更新小说列表
  - 分类导航：分类状态在导航组件中体现

#### 2.6 排行榜模块 (rankingStore)
- 状态：
  - `rankings`: 排行榜数据
  - `rankingType`: 当前排行榜类型（total/today/week/month）
  - `rankingTimeRange`: 时间范围选择
- 操作：
  - `fetchRankings(type, params)`: 获取排行榜数据
  - `changeRankingType(type)`: 切换排行榜类型
  - `updateTimeRange(range)`: 更新时间范围
- Getter：
  - `currentRankings`: 当前排行榜数据
  - `rankingTitle`: 排行榜标题
- UI交互：
  - 排行榜切换：类型变更即时更新显示
  - 时间范围：时间范围选择与数据同步

#### 2.7 评论模块 (commentStore)
- 状态：
  - `comments`: 评论列表
  - `currentComment`: 当前编辑的评论
  - `commentPagination`: 评论分页信息
- 操作：
  - `fetchComments(novelId, chapterId, params)`: 获取评论列表
  - `addComment(comment)`: 添加评论
  - `updateComment(id, content)`: 更新评论
  - `deleteComment(id)`: 删除评论
  - `likeComment(id)`: 点赞评论
- Getter：
  - `sortedComments`: 排序后的评论列表
  - `commentCount`: 评论总数
- UI交互：
  - 评论实时更新：评论操作即时更新UI
  - 点赞状态：点赞状态同步显示

#### 2.8 评分模块 (ratingStore)
- 状态：
  - `ratings`: 评分列表
  - `userRating`: 用户对当前小说的评分
  - `averageRating`: 平均评分
- 操作：
  - `fetchRatings(novelId, params)`: 获取评分列表
  - `addRating(rating)`: 添加评分
  - `updateRating(id, rating)`: 更新评分
  - `deleteRating(id)`: 删除评分
  - `likeRating(id)`: 点赞评分
- Getter：
  - `ratingStats`: 评分统计信息
  - `ratingDistribution`: 评分分布
- UI交互：
  - 评分状态：评分状态在多个组件间同步
  - 评分分布：分布数据可视化显示

#### 2.9 审核模块 (reviewStore)
- 状态：
  - `pendingNovels`: 待审核小说列表
  - `selectedNovels`: 已选中的小说ID集合（用于批量操作）
  - `currentReviewNovel`: 当前正在审核的小说详情
  - `reviewStats`: 审核统计信息（待审核数量、今日审核数量等）
  - `reviewLoading`: 审核相关加载状态
  - `reviewError`: 审核错误信息
- 操作：
  - `fetchPendingNovels(params)`: 获取待审核小说列表
  - `selectNovel(id)`: 选择/取消选择小说（用于批量操作）
  - `selectAllNovels()`: 选择所有小说
  - `clearSelection()`: 清空选择
  - `fetchNovelForReview(id)`: 获取小说详情用于审核
  - `approveNovel(id, reason)`: 审核通过单个小说
  - `rejectNovel(id, reason)`: 审核拒绝单个小说
  - `batchApproveNovels(ids, reason)`: 批量审核通过
  - `batchRejectNovels(ids, reason)`: 批量审核拒绝
  - `fetchReviewStats()`: 获取审核统计信息
- Getter：
  - `selectedCount`: 已选中的小说数量
  - `hasSelection`: 是否有选中的小说
  - `filteredPendingNovels`: 过滤后的待审核小说列表
  - `reviewProgress`: 审核进度统计
- UI交互：
  - 批量操作：选中状态与UI组件同步
  - 审核操作：审核结果即时更新列表

### 3. 数据流设计

#### 3.1 单向数据流
```
组件触发Action → Store处理逻辑 → 更新State → 组件重新渲染
```

#### 3.2 异步操作处理
- 使用async/await处理异步API调用
- 统一错误处理机制
- 加载状态管理
- 请求取消机制
- UI交互：
  - 加载状态：异步操作时显示加载指示
  - 错误处理：异步操作失败时显示错误信息

#### 3.3 状态更新策略
- 乐观更新：对于用户操作（如点赞、评论），先更新本地状态，再发送请求
- 悲观更新：对于重要操作（如支付、删除），先发送请求，成功后再更新状态
- 批量更新：对于频繁操作（如阅读进度），使用防抖批量更新
- UI交互：
  - 乐观更新反馈：操作后立即显示结果，失败时回滚
  - 确认操作：重要操作前显示确认对话框

### 4. 状态持久化

#### 4.1 本地存储策略
- 使用pinia-plugin-persistedstate插件
- 持久化数据：
  - 用户认证信息（token）
  - 阅读进度和设置
  - UI主题偏好
  - 搜索历史
  - 本地缓存的小说内容
  - 用户个性化配置
- 存储方式：
  - `localStorage`：长期存储（用户设置、阅读进度）
  - `sessionStorage`：会话存储（临时数据）
  - `IndexedDB`：大量数据存储（阅读历史、缓存数据）
- 存储空间管理：
  - 定期清理过期数据
  - 存储空间使用监控
  - 数据压缩和序列化
  - 存储配额超限处理
- 数据安全：
  - 敏感数据加密存储
  - 存储数据访问权限控制
  - 数据备份和恢复机制
- UI交互：
  - 存储状态：显示存储使用情况
  - 数据同步：跨设备数据同步状态
  - 清理提示：存储空间不足时的提示和清理选项

#### 4.2 数据同步机制
- 服务器同步：重要数据（阅读进度）定期同步到服务器
- 冲突解决：使用时间戳解决数据冲突（以最新数据为准）
- 离线支持：本地缓存支持离线阅读
- 同步状态：显示数据同步状态和进度
- UI交互：
  - 同步状态：显示数据同步状态
  - 冲突处理：数据冲突时的处理提示

### 5. 状态共享和通信

#### 5.1 组件间通信
- Props/Events：父子组件通信
  - Props：父组件向子组件传递数据
  - Events：子组件向父组件传递事件
  - 类型验证：使用TypeScript定义Props类型
- Provide/Inject：跨层级组件通信
  - 适用于祖代组件向后代组件传递数据
  - 使用Symbol作为Provide/Inject的标识符
- Event Bus：全局事件通信（使用mitt库）
  - 适用于非父子关系组件通信
  - 事件命名规范：采用动词+名词的形式（如user-login）
  - 事件清理：组件销毁时清理事件监听器
- Store：复杂状态共享
  - 适用于全局状态管理
  - 遵循单向数据流原则
- Composables：逻辑复用和状态共享
  - 封装可复用的业务逻辑
  - 使用ref、reactive等响应式API
- UI交互：
  - 状态同步：跨组件状态同步

#### 5.2 Store间通信
- 组合Store：一个Store可以导入和使用其他Store
- 共享状态：通过rootState访问其他模块的状态
- 动作协调：跨模块的动作协调
- Store依赖管理：避免Store间的循环依赖
- UI交互：
  - 跨模块状态更新：状态变更在相关UI组件中同步

### 6. 性能优化

#### 6.1 状态分割
- 按功能模块分割状态，减少不必要的重新渲染
- 使用计算属性缓存计算结果
- 使用watchEffect处理副作用
- UI交互：
  - 渲染性能：优化状态变化对UI渲染的影响

#### 6.2 内存管理
- 及时清理不再使用的状态
- 使用弱引用存储大型数据
- 实现垃圾回收机制
- UI交互：
  - 内存状态：显示内存使用情况（开发环境）

#### 6.3 状态快照
- 支持状态快照和恢复
- 开发工具集成（Vue DevTools）
- 状态调试和监控
- UI交互：
  - 调试支持：开发环境下的状态调试功能

### 7. 错误处理

#### 7.1 状态错误处理
- 统一错误状态管理
- 错误边界组件
- 错误恢复机制
- UI交互：
  - 错误状态：统一的错误状态显示和处理

#### 7.2 网络错误处理
- 请求重试机制
- 离线状态检测
- 数据同步恢复
- UI交互：
  - 网络错误：网络错误时的UI提示和处理

## 路由设计

### 1. 路由结构
- 首页 (/)：推荐小说展示，包含搜索框、推荐列表
- 分类页 (/categories)：小说分类浏览，显示分类列表和对应小说
- 排行榜 (/rankings)：阅读次数排行榜，支持多时间范围选择
- 上传页 (/upload)：上传txt、epub格式小说，包含上传表单和上传记录
- 小说列表 (/novels)：展示所有小说列表，支持分页和筛选
- 小说详情 (/novels/:id)：小说详细信息展示，包含简介、评分、目录等
- 阅读页面 (/novels/:id/read)：小说阅读界面，支持翻页和设置
- 搜索页面 (/search?q=keyword)：搜索结果展示页面
- 用户中心 (/user)：用户个人中心、注册登录入口
- 管理员审核 (/admin/review)：管理员审核页面（仅管理员可见）
- 关于我们 (/about)：关于我们页面
  - UI设计：
    - 面包屑导航：显示当前页面路径，字体大小2.5vw（约12px）
    - 页面标题：根据路由动态更新页面标题，字体大小3.5vw（约16px）
    - 加载状态：路由切换时的加载指示，高度0.4vw（约2px），主题色背景
### 2. 路由守卫
- 认证守卫：保护需要登录的页面
  - 登录状态检查：检查用户是否已登录
  - 未登录跳转：未登录用户跳转到登录页面
  - 权限验证：验证用户权限
- 权限守卫：保护管理员页面
  - 管理员权限检查：检查用户是否为管理员
  - 权限不足处理：权限不足时显示错误页面
- 数据预加载：在路由切换前预加载必要数据
  - 小说详情预加载：小说详情页预加载小说数据
  - 用户信息预加载：用户相关页面预加载用户数据
  - 分类数据预加载：分类页面预加载分类数据
- UI交互：
  - 导航状态：当前路由在导航栏中高亮显示
  - 权限提示：权限不足时的友好提示
  - 预加载：页面内容预加载时的加载状态

### 3. 路由动画
- 页面切换动画：平滑的页面切换效果
- UI设计：
  - 过渡动画：页面切换时的过渡效果
  - 加载指示：页面加载时的指示器

## 代码组织和开发原则

### 1. 组件化开发
- 使用第三方库不重复造轮子：
  - UI组件：使用Element Plus或Naive UI等成熟组件库
  - 阅读器：使用epub.js处理EPUB格式
  - 虚拟滚动：使用vue-virtual-scroll-list优化长列表
  - 表单验证：使用vee-validate
  - 状态管理：使用Pinia
  - 路由管理：使用Vue Router
  - HTTP请求：使用Axios
  - 日期处理：使用dayjs或moment.js
  - 构建工具：使用Vite

- 功能模块分离：
  - 按业务功能划分组件目录：
    ```
    frontend/
    ├── public/               # 静态资源
    ├── src/
    │   ├── assets/           # 静态资源
    │   │   ├── images/       # 图片资源
    │   │   ├── icons/        # 图标资源
    │   │   └── styles/       # 全局样式
    │   ├── components/       # 可复用组件
    │   │   ├── common/       # 通用基础组件
    │   │   │   ├── Button.vue
    │   │   │   ├── Input.vue
    │   │   │   ├── Modal.vue
    │   │   │   └── Loading.vue
    │   │   ├── reading/      # 阅读相关组件
    │   │   │   ├── Reader.vue
    │   │   │   ├── Catalog.vue
    │   │   │   ├── SettingsPanel.vue
    │   │   │   └── ProgressBar.vue
    │   │   ├── novel/        # 小说相关组件
    │   │   │   ├── NovelCard.vue
    │   │   │   ├── NovelList.vue
    │   │   │   └── NovelDetail.vue
    │   │   ├── user/         # 用户相关组件
    │   │   │   ├── UserProfile.vue
    │   │   │   ├── Login.vue
    │   │   │   └── Register.vue
    │   │   └── social/       # 社交相关组件
    │   │       ├── CommentList.vue
    │   │       ├── CommentItem.vue
    │   │       └── Rating.vue
    │   ├── views/            # 页面组件
    │   │   ├── Home.vue      # 首页
    │   │   ├── Category.vue  # 分类页
    │   │   ├── Ranking.vue   # 排行榜页
    │   │   ├── Upload.vue    # 上传页
    │   │   ├── NovelDetail.vue # 小说详情页
    │   │   ├── Reading.vue   # 阅读页
    │   │   ├── UserCenter.vue # 用户中心
    │   │   └── Admin.vue     # 管理员页面
    │   ├── composables/      # 可复用逻辑
    │   │   ├── useAuth.js    # 认证逻辑
    │   │   ├── useReading.js # 阅读逻辑
    │   │   └── useNovel.js   # 小说逻辑
    │   ├── stores/           # 状态管理 (Pinia)
    │   │   ├── user.js       # 用户状态
    │   │   ├── novel.js      # 小说状态
    │   │   ├── reading.js    # 阅读状态
    │   │   └── ui.js         # UI状态
    │   ├── router/           # 路由配置
    │   │   └── index.js
    │   ├── services/         # API服务
    │   │   ├── api.js        # API基础配置
    │   │   ├── novel.js      # 小说相关API
    │   │   ├── user.js       # 用户相关API
    │   │   └── reading.js    # 阅读相关API
    │   ├── utils/            # 工具函数
    │   │   ├── validators.js # 验证工具
    │   │   ├── formatters.js # 格式化工具
    │   │   └── helpers.js    # 辅助工具
    │   ├── constants/        # 常量定义
    │   │   ├── api.js        # API常量
    │   │   ├── routes.js     # 路由常量
    │   │   └── themes.js     # 主题常量
    │   ├── types/            # TypeScript类型定义
    │   │   ├── user.ts       # 用户类型
    │   │   ├── novel.ts      # 小说类型
    │   │   └── api.ts        # API类型
    │   └── styles/           # 样式文件
    │       ├── variables.css # CSS变量
    │       ├── mixins.css    # CSS混入
    │       └── global.css    # 全局样式
    ├── package.json
    └── vite.config.js
    ```
  - 每个组件职责单一，只关注自己的功能
  - 组件之间通过props和事件通信
  - 复杂业务逻辑抽离到Composables
  - 组件文件结构规范：
    - 组件名使用PascalCase命名法
    - 每个组件文件包含template、script、style三个部分
    - 组件内部逻辑按setup、props、emits、data、computed、methods顺序组织

- 组件和工具类封装：
  - 可复用组件：提取通用UI组件
  - 工具函数：utils目录下放置通用工具函数
  - API封装：统一管理API请求
  - 常量定义：constants目录下定义常量
  - 类型定义：types目录下定义TypeScript类型
  - 逻辑封装：composables目录下封装可复用逻辑

### 2. 状态管理规范
- 使用Pinia进行状态管理
- 按功能模块划分store：
  - userStore：用户相关状态
  - novelStore：小说相关状态
  - readingStore：阅读相关状态
  - uiStore：UI相关状态
  - commentStore：评论相关状态
- 状态分层：全局状态、页面状态、组件状态
- 状态持久化：使用pinia-plugin-persistedstate

### 3. API交互规范
- 统一API接口管理
- 使用Axios拦截器处理请求/响应
- 统一错误处理机制
- 请求缓存策略
- 防抖和节流机制

### 4. 样式规范
- 使用CSS变量管理主题
- 移动优先的响应式设计
- 组件样式隔离
- 命名规范：BEM方法论

### 5. 性能优化
- 虚拟滚动处理长列表
- 图片懒加载
- 组件懒加载
- 代码分割
- 缓存策略

## 测试策略

### 1. 单元测试
- 使用Vue Test Utils和Jest进行组件单元测试
- 测试覆盖率达到80%以上
- 主要测试业务逻辑、API交互逻辑、状态管理逻辑
- 为每个组件编写独立的测试用例
- 持续集成中包含测试执行步骤

### 2. 集成测试
- 使用Cypress进行端到端测试
- 测试用户完整的操作流程
- 验证API接口调用的正确性
- 测试不同设备和浏览器兼容性
- 自动化测试流程集成到CI/CD管道

### 3. UI测试
- 使用Storybook构建组件文档和测试环境
- 视觉回归测试，确保UI一致性
- 交互测试，验证用户操作的响应

## 代码质量规范

### 1. 代码规范
- 使用ESLint + Prettier进行代码格式化
- 遵循Vue官方风格指南
- TypeScript类型定义完整
- 组件命名规范：大写字母开头的PascalCase
- 文件命名规范：功能名+.vue/.ts/.js

### 2. Git规范
- 使用约定式提交（Conventional Commits）
- 分支命名规范：feature/功能名、bugfix/问题描述、hotfix/紧急修复
- 代码审查流程：所有PR需经过至少一人审查

### 3. 文档规范
- 组件文档：每个组件需包含Props、Events、Slots说明
- API文档：接口调用示例和参数说明
- 配置文档：环境变量和构建配置说明

## 性能监控

### 1. 性能指标
- 首屏加载时间（FMP）：小于3秒
- 交互响应时间（TTI）：小于5秒
- 用户体验指标（Core Web Vitals）
- 页面加载性能监控

### 2. 监控工具
- 集成Sentry进行错误监控和上报
- 使用Lighthouse进行性能分析
- 前端性能监控SDK，收集用户真实体验数据

### 3. 性能优化验证
- 构建时压缩和优化
- 代码分割和懒加载验证
- 图片和资源优化验证

## 部署和CI/CD

### 1. 构建配置
- Vite生产构建优化
- 环境变量管理：开发、测试、生产环境区分
- 静态资源优化：压缩、缓存、CDN配置

### 2. 部署流程
- 自动化构建和部署流水线
- 版本管理和发布流程
- 回滚机制和应急预案

### 3. 环境管理
- 开发环境：本地开发，调试工具开启
- 测试环境：功能测试，性能测试
- 预发布环境：最终验证
- 生产环境：用户访问，安全和性能优化

## 可访问性规范

### 1. 无障碍访问标准
- 遵循WCAG 2.1 AA标准
- 键盘导航支持
- 屏幕阅读器兼容性
- 颜色对比度符合标准
- 语义化HTML结构

### 2. 可访问性实现
- ARIA标签和属性使用
- 焦点管理
- 适当的标题层级结构
- 替代文本（alt）提供

## 国际化支持（预留）

### 1. 国际化架构
- 使用vue-i18n进行多语言支持
- 语言包组织结构
- 动态语言切换功能

### 2. 本地化考虑
- 文字方向支持（LTR/RTL）
- 数字、日期、货币格式化
- 文化差异适配

## 安全规范

### 1. 前端安全
- XSS防护：输入验证和输出转义
- CSRF防护：使用token验证
- 数据加密：敏感信息加密存储
- API安全：请求验证和认证

### 2. 内容安全
- 内容安全策略（CSP）配置
- 第三方资源安全验证
- 用户生成内容过滤

## 后续扩展功能

### 1. 社交功能扩展
- 用户关注系统
- 更复杂的评论互动（多层级评论）
- 个性化推荐算法

### 2. 高级阅读功能
- 自定义主题和布局
- 高级阅读统计
- 书签和笔记功能

### 3. 高级管理功能
- 数据分析和报表
- 用户行为分析
- 高级审核工具