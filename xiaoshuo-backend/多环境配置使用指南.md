# 多环境配置使用指南

本项目支持多环境配置，允许使用不同的配置文件来适应不同的运行环境（本地、开发、测试、生产等）。

## 配置文件

项目支持以下配置文件：

- `config.yaml` - 默认配置文件
- `config.local.yaml` - 本地开发环境配置
- `config.prod.yaml` - 生产环境配置
- `config.{env}.yaml` - 其他环境配置文件

## 使用方式

### 1. 命令行参数方式

```bash
# 使用本地环境配置
go run main.go -env=local

# 使用生产环境配置
go run main.go -env=prod

# 使用其他环境配置
go run main.go -env=test
```

### 2. 环境变量方式

```bash
# Windows
$env:APP_ENV="local"; go run main.go

# Linux/Mac
APP_ENV=local go run main.go
```

### 3. 构建可执行文件

```bash
# 构建并使用本地环境配置运行
go build -o server . && ./server -env=local

# 构建并使用生产环境配置运行
go build -o server . && ./server -env=prod
```

## 配置文件结构

所有配置文件都遵循相同的结构：

```yaml
server:
  port: "8888"      # 服务器端口
  mode: "debug"     # 运行模式 (debug/release)
  base_path: "/api/v1"  # API基础路径

database:
  host: "localhost" # 数据库主机
  port: "3306"      # 数据库端口
  user: "root"      # 数据库用户
  password: "password" # 数据库密码
  dbname: "database_name" # 数据库名
  charset: "utf8mb4" # 字符集

redis:
  addr: "localhost:6379" # Redis地址
  password: ""        # Redis密码
  db: 0               # Redis数据库编号

jwt:
  secret: "secret_key" # JWT密钥
  expires: 3600       # JWT过期时间（秒）
```

## 环境配置示例

### 本地开发环境 (config.local.yaml)
```yaml
server:
  port: "8888"
  mode: "debug"
  base_path: "/api/v1"

database:
  host: "localhost"
  port: "3306"
  user: "root"
  password: "Ld588588"
  dbname: "xiaoshuo_dev"
  charset: "utf8mb4"

redis:
  addr: "localhost:6379"
  password: ""
  db: 0

jwt:
  secret: "xiaoshuo_local_secret_key"
  expires: 3600
```

### 生产环境 (config.prod.yaml)
```yaml
server:
  port: "8888"
  mode: "release"
  base_path: "/api/v1"

database:
  host: "prod-db-host"
  port: "3306"
  user: "prod_user"
  password: "prod_password"
  dbname: "xiaoshuo_prod"
  charset: "utf8mb4"

redis:
  addr: "prod-redis-host:6379"
  password: "prod_redis_password"
  db: 0

jwt:
  secret: "xiaoshuo_prod_secret_key"
  expires: 3600
```