# 小说阅读系统后端需求文档

## 项目概述

本项目后端部分使用Go语言、Gin框架和Gorm ORM，为前端提供RESTful API服务。后端负责业务逻辑处理、数据存储和安全控制。系统仅支持中文。

## 项目结构

```
backend/
├── main.go           # 主程序入口
├── models/           # 数据模型
├── controllers/      # 控制器
├── routes/           # 路由定义
├── middleware/       # 中间件
├── utils/            # 工具函数
├── config/           # 后端配置
└── migrations/       # 数据库迁移
```

## 技术栈

- Go语言 (1.19+)
- Gin框架 (Web框架)
- Gorm (ORM框架)
- MySQL (数据库)
- Viper (配置管理)
- Logrus (日志管理)
- Godotenv (环境变量管理)

## 数据库设计

### 1. 用户表 (users)
- id: 主键，自增
- email: 邮箱（唯一，用于登录）
- password: 密码（加密存储）
- nickname: 昵称（可选，默认为邮箱）
- is_active: 用户状态（布尔值，默认true，false表示被冻结）
- is_admin: 管理员状态（布尔值，默认false，true表示管理员）
- last_login_at: 最后登录时间
- created_at: 创建时间
- updated_at: 更新时间

### 2. 小说表 (novels)
- id: 主键，自增
- title: 小说标题
- author: 作者
- protagonist: 主角名称
- description: 描述
- file_path: 文件路径
- file_size: 文件大小
- word_count: 字数统计
- click_count: 总点击量
- today_clicks: 今日点击量
- week_clicks: 本周点击量
- month_clicks: 本月点击量
- upload_time: 上传时间
- last_read_time: 最后阅读时间
- status: 小说状态 (pending-审核中, approved-已通过, rejected-已拒绝)
- file_hash: 文件hash值 (用于防止重复上传)
- created_at: 创建时间
- updated_at: 更新时间

### 3. 管理员操作日志表 (admin_logs)
- id: 主键，自增
- admin_user_id: 执行操作的管理员ID
- action: 操作类型 (approve_novel-审核通过小说, reject_novel-审核拒绝小说, modify_novel-退回修改小说, batch_approve_novel-批量审核小说, freeze_user-冻结用户, unfreeze_user-解冻用户等)
- target_type: 目标类型 (novel-小说, user-用户, comment-评论, rating-评分)
- target_id: 目标ID
- details: 操作详情(json格式)
- result: 操作结果 (success-成功, failed-失败)
- ip_address: 操作IP地址
- created_at: 创建时间
- updated_at: 更新时间

### 10. 管理员操作日志管理
- **日志记录**: 管理员操作会记录到操作日志中，日志包含操作时间、操作人、操作类型、操作对象、操作结果、IP地址等详细信息
- **日志查询**: 管理员可按时间范围、操作类型、操作人等条件查询操作日志
- **日志导出**: 支持将操作日志导出为CSV格式
- **日志存储管理**: 日志存储期限为1年，超过期限的日志会被自动清理
- **第三方库**: 使用第三方库如zap或logrus实现操作日志记录，使用第三方库如gorm实现数据库日志存储

### 2. 分类表 (categories)
- id: 主键，自增
- name: 分类名
- description: 分类描述
- created_at: 创建时间
- updated_at: 更新时间

### 6. 关键词表 (keywords)
- id: 主键，自增
- keyword: 关键词
- created_at: 创建时间
- updated_at: 更新时间

### 7. 小说关键词关联表 (novel_keywords)
- id: 主键，自增
- novel_id: 小说ID，外键
- keyword_id: 关键词ID，外键

### 8. 小说分类关联表 (novel_categories)
- id: 主键，自增
- novel_id: 小说ID，外键
- category_id: 分类ID，外键



### 5. 系统消息表 (system_messages)
- id: 主键，自增
- user_id: 接收用户ID
- title: 消息标题
- content: 消息内容
- type: 消息类型 (notification-通知, warning-警告, info-信息)
- is_read: 是否已读（布尔值，默认false）
- created_at: 创建时间
- updated_at: 更新时间

### 5. 评论表 (comments)
- id: 主键，自增
- user_id: 用户ID，外键（关联用户表）
- novel_id: 小说ID，外键
- chapter_id: 章节ID
- parent_id: 父评论ID，自关联（支持一级回复，使用第三方库如go-xorm处理树形结构）
- content: 评论内容（最多500字符）
- like_count: 点赞数
- created_at: 创建时间
- updated_at: 更新时间

### 5. 评分表 (ratings)
- id: 主键，自增
- user_id: 用户ID，外键（关联用户表）
- novel_id: 小说ID，外键
- rating: 评分 (1-5)
- review: 评分说明（对小说的评论，最多250个字符）
- like_count: 点赞数
- created_at: 创建时间
- updated_at: 更新时间

### 6. 评分点赞表 (rating_likes)
- id: 主键，自增
- user_id: 用户ID，外键（关联用户表）
- rating_id: 评分ID，外键（关联评分表）
- created_at: 创建时间

### 7. 评论点赞表 (comment_likes)
- id: 主键，自增
- user_id: 用户ID，外键（关联用户表）
- comment_id: 评论ID，外键（关联评论表）
- created_at: 创建时间

数据库操作使用Gorm ORM库实现，数据验证使用validator库。

## API接口设计

### 1. 用户模块

#### 1.1 用户注册
- **路径**: POST /api/v1/users/register
- **请求参数**:
  - email: 邮箱（符合邮箱格式）
  - password: 密码
  - nickname: 昵称（可选）
- **响应**: 用户信息和认证token
- **处理流程**:
  1. 验证邮箱格式（使用github.com/go-playground/validator/v10库）
  2. 检查邮箱是否已存在
  3. 检查昵称是否重复（非强制唯一，但会提示用户）
  4. 如果未提供昵称，则使用邮箱作为默认昵称
  5. 密码加密存储（使用golang.org/x/crypto/bcrypt库）
  6. 创建用户记录（默认is_active=true, is_admin=false）
  7. 生成JWT token（使用github.com/golang-jwt/jwt/v4库）

#### 1.2 用户登录
- **路径**: POST /api/v1/users/login
- **请求参数**:
  - email: 邮箱
  - password: 密码
- **响应**: 用户信息和认证token
- **处理流程**:
  1. 验证用户凭据
  2. 密码验证（使用bcrypt库）
  3. 生成JWT token

#### 1.3 获取用户信息
- **路径**: GET /api/v1/users/profile
- **认证**: JWT token
- **响应**: 用户详细信息

#### 1.4 更新用户信息
- **路径**: PUT /api/v1/users/profile
- **认证**: JWT token
- **请求参数**:
  - nickname: 昵称（可选）
- **响应**: 更新后的用户信息
- **处理流程**:
  1. 验证用户认证
  2. 更新用户昵称
  3. 返回更新后的用户信息

#### 1.6 获取用户上传的小说列表
- **路径**: GET /api/v1/users/novels/uploaded
- **认证**: JWT token
- **查询参数**:
  - page: 页码 (默认1)
  - limit: 每页数量 (默认20)
  - show_pending: 是否显示审核中的小说 (默认true)
- **响应**: 分页的用户上传小说列表

#### 1.7 获取用户的评论列表
- **路径**: GET /api/v1/users/comments
- **认证**: JWT token
- **查询参数**:
  - page: 页码 (默认1)
  - limit: 每页数量 (默认20)
- **响应**: 分页的用户评论列表

#### 1.8 获取用户的评分列表
- **路径**: GET /api/v1/users/ratings
- **认证**: JWT token
- **查询参数**:
  - page: 页码 (默认1)
  - limit: 每页数量 (默认20)
- **响应**: 分页的用户评分列表

#### 6.4 删除评论
- **路径**: DELETE /api/v1/comments/:id
- **认证**: JWT token
- **路径参数**: id - 评论ID
- **响应**: 操作结果
- **处理流程**:
  1. 验证用户认证
  2. 验证用户权限（只能删除自己的评论）
  3. 从数据库删除评论
  4. 更新相关计数（如章节评论数）

#### 6.5 评论删除权限管理
- **说明**: 评论删除权限分为普通用户和管理员，普通用户只能删除自己发布的评论，管理员可以删除任何用户的评论，删除时需记录操作日志
- **处理流程**:
  1. 检查当前用户是否为评论发布者
  2. 如果是发布者，允许删除
  3. 如果当前用户是管理员，允许删除任何评论
  4. 删除评论时记录操作日志到admin_logs表
  5. 更新相关计数（如章节评论数）
- **权限验证**: 普通用户只能删除自己发布的评论，管理员可删除任何评论
- **日志记录**: 使用第三方库如zap记录admin_logs

#### 9.5 删除评分
- **路径**: DELETE /api/v1/ratings/:id
- **认证**: JWT token
- **路径参数**: id - 评分ID
- **响应**: 操作结果
- **处理流程**:
  1. 验证用户认证
  2. 验证用户权限（只能删除自己的评分）
  3. 从数据库删除评分
  4. 更新相关计数（如小说平均评分）

#### 9.6 评分删除权限管理
- **说明**: 评分删除权限分为普通用户和管理员，普通用户只能删除自己发布的评分，管理员可以删除任何用户的评分，删除时需记录操作日志
- **处理流程**:
  1. 检查当前用户是否为评分发布者
  2. 如果是发布者，允许删除
  3. 如果当前用户是管理员，允许删除任何评分
  4. 删除评分时记录操作日志到admin_logs表
  5. 更新相关计数（如小说平均评分）
- **权限验证**: 普通用户只能删除自己发布的评分，管理员可删除任何评分
- **日志记录**: 使用第三方库如zap记录admin_logs

#### 1.11 获取用户列表（管理员）
- **路径**: GET /api/v1/admin/users
- **认证**: JWT token
- **查询参数**:
  - page: 页码 (默认1)
  - limit: 每页数量 (默认20)
  - status: 用户状态 (active, inactive, all)
- **响应**: 分页的用户列表

#### 1.12 冻结用户（管理员）
- **路径**: POST /api/v1/admin/users/:id/freeze
- **认证**: JWT token
- **路径参数**: id - 用户ID
- **响应**: 操作结果
- **处理流程**:
  1. 验证用户认证
  2. 验证用户权限（必须是管理员）
  3. 将目标用户状态设置为冻结（is_active = false）
  4. 记录操作日志

#### 1.13 解冻用户（管理员）
- **路径**: POST /api/v1/admin/users/:id/unfreeze
- **认证**: JWT token
- **路径参数**: id - 用户ID
- **响应**: 操作结果
- **处理流程**:
  1. 验证用户认证
  2. 验证用户权限（必须是管理员）
  3. 将目标用户状态设置为激活（is_active = true）
  4. 记录操作日志

#### 1.14 获取用户列表（管理员）
- **路径**: GET /api/v1/admin/users
- **认证**: JWT token
- **查询参数**:
  - page: 页码 (默认1)
  - limit: 每页数量 (默认20)
  - status: 用户状态 (active, inactive, all)
- **响应**: 分页的用户列表

#### 1.15 冻结用户内容显示处理
- **说明**: 被冻结用户已发布的内容（评论、评分等）会保留在系统中，在显示时标注"发布者已被冻结"的标签，标签样式为灰色徽章形式，冻结用户的评论和评分在排序中权重降低，不会影响热门排序
- **处理流程**:
  1. 在返回评论和评分数据时，检查发布用户的状态
  2. 如果用户被冻结，则在返回数据中添加冻结标识
  3. 在排序算法中降低冻结用户内容的权重
- **冻结判断逻辑**: 当用户is_active字段为false时立即生效
- **冻结用户内容处理**:
  - 内容保留：被冻结用户已发布的内容（评论、评分等）会保留在系统中
  - 冻结标识：在返回数据中添加"发布者已被冻结"标识
  - 排序权重：冻结用户的评论和评分在排序中权重降低（权重系数0.5）
  - 阅读进度处理：冻结用户的阅读进度和历史记录正常保存和显示
  - 阅读权限：冻结用户仍可阅读已有小说内容，但不会增加小说点击量
  - 通知机制：向关注该用户的其他用户发送通知（可选功能）

#### 1.13 解冻用户（管理员）
- **路径**: POST /api/v1/admin/users/:id/unfreeze
- **认证**: JWT token
- **路径参数**: id - 用户ID
- **响应**: 操作结果
- **处理流程**:
  1. 验证用户认证
  2. 验证用户权限（必须是管理员）
  3. 将目标用户状态设置为激活（is_active = true）
  4. 记录操作日志

#### 1.14 获取用户未读消息列表
- **路径**: GET /api/v1/users/unread-messages
- **认证**: JWT token
- **查询参数**:
  - page: 页码 (默认1)
  - limit: 每页数量 (默认10)
- **响应**: 分页的未读消息列表
- **处理流程**:
  1. 验证用户认证
  2. 查询用户的未读消息
  3. 按时间倒序排列
  4. 返回分页结果

#### 1.15 删除冻结用户的未审核小说（管理员）
- **路径**: DELETE /api/v1/admin/users/:id/pending-novels
- **认证**: JWT token
- **路径参数**: id - 用户ID
- **响应**: 操作结果
- **处理流程**:
  1. 验证用户认证
  2. 验证用户权限（必须是管理员）
  3. 验证目标用户是否被冻结
  4. 删除该用户所有状态为"审核中"的小说记录
  5. 从文件系统删除对应的小说文件
  6. 删除相关评论、评分等关联数据
  7. 记录操作日志

### 2. 小说模块

#### 2.1 上传小说
- **路径**: POST /api/v1/novels/upload
- **认证**: JWT token
- **请求**: multipart/form-data
  - file: 小说文件 (txt, epub)
  - filename: 原始文件名
  - title: 标题 (可选，如未提供则从文件提取)
  - author: 作者 (可选，如未提供则从文件提取)
  - protagonist: 主角名称 (可选，如未提供则从文件提取)
  - description: 描述 (可选)
- **处理流程**:
  1. 验证用户认证
  2. 检查用户是否被冻结（is_active字段）
  3. 检查用户是否为管理员（is_admin字段），如果是管理员则跳过上传限制检查；否则检查用户当日上传次数是否超过限制（每日最多10本，使用golang.org/x/time/rate库实现频率限制）
  4. 验证文件格式（使用filetype库），如不支持则返回错误："仅支持txt和epub格式"
  5. 验证文件大小（最大20MB），如超限则返回错误："文件大小不能超过20MB"
  6. 计算文件hash值（使用crypto/sha256库）
  7. 检查文件hash是否已存在，如存在则返回错误："该文件已存在"
  8. 保存文件到指定目录
  9. 提取小说元数据（包括主角名称，使用golang-epub库处理EPUB文件）
  10. 计算并存储字数统计（使用golang-runewidth库）
  11. 创建小说记录（状态为审核中，关联上传用户ID）

  - 章节管理：
    - 章节识别：
      - EPUB格式：使用第三方库如go-epub自动提取章节标题和结构
      - TXT格式：使用第三方库如go-regexp识别多种章节标记，包括：
        - 中文数字：/^第[一二三四五六七八九十百千万]+[章节回].*$/
        - 阿拉伯数字：/^第\d+[章节回].*$/
        - 零填充数字：/^第\d{3,4}[章节回].*$/
        - 卷标：/^第[一二三四五六七八九十百千万\d]+卷.*$/
      - 章节边界识别：使用第三方库如xregexp实现复杂的正则匹配
    - 章节字数统计（使用第三方库如golang-runewidth）
    - 章节预览功能：
      - 截取规则：截取章节内容到超过200字符的下一个句号、问号、感叹号或段落结束
      - 实现方式：使用第三方库如go-runewidth计算字符长度，strings库处理文本截取
      - 智能截取：避免在词语中间截断，使用第三方库如go-nilan进行词边界识别
      - 语义完整性：使用第三方库如go-nlp确保截取内容的语义完整性
    - 章节索引：为每个章节建立索引，便于快速定位和跳转
    - 章节缓存：对解析后的章节内容进行缓存，提高访问效率

#### 2.1.1 上传频率限制
- **说明**: 每个用户每日上传小说数量限制为10本，按自然日（00:00-23:59）计算，管理员用户不受此限制
- **实现方式**: 使用第三方库如golang.org/x/time/rate实现频率限制
- **处理流程**:
  1. 记录每个用户每日的上传次数
  2. 检查当前日期的上传次数是否超过限制
  3. 如果超过限制，返回错误："今日上传次数已达上限，请明天再试"
- **响应**: 小说信息
- **错误响应**:
  - 400: 文件格式不支持、文件大小超限、文件hash重复
  - 403: 用户被冻结、上传次数超限
  - 500: 服务器内部错误

#### 2.2 获取小说列表
- **路径**: GET /api/v1/novels
- **查询参数**:
  - page: 页码 (默认1)
  - limit: 每页数量 (默认20)
  - keyword: 搜索关键词
  - category: 分类ID
  - show_pending: 是否显示审核中的小说 (默认true)
- **响应**: 分页的小说列表（包含上传用户信息，如昵称）

#### 2.3 获取用户上传的小说列表
- **路径**: GET /api/v1/novels/uploaded
- **认证**: JWT token
- **查询参数**:
  - page: 页码 (默认1)
  - limit: 每页数量 (默认20)
  - show_pending: 是否显示审核中的小说 (默认true)
- **响应**: 分页的上传小说列表（包含上传用户信息，如昵称）

#### 2.4 获取推荐小说列表
- **路径**: GET /api/v1/novels/recommend
- **查询参数**:
  - limit: 数量限制 (默认20)
  - show_pending: 是否显示审核中的小说 (默认false)
- **响应**: 推荐小说列表

#### 2.5 获取小说详情
- **路径**: GET /api/v1/novels/:id
- **路径参数**: id - 小说ID
- **响应**: 小说详细信息（包含字数统计、主角名称、分类信息、关键词、上传用户信息如昵称）。如果用户已登录，还返回该用户的阅读进度、是否已评分、是否已点赞等个性化信息。

#### 2.6 获取小说内容
- **路径**: GET /api/v1/novels/:id/content
- **路径参数**: id - 小说ID
- **响应**: 小说内容

#### 2.7 记录小说点击量
- **路径**: POST /api/v1/novels/:id/click
- **路径参数**: id - 小说ID
- **处理流程**:
  1. 验证小说存在性
  2. 检查用户是否已阅读过此小说（用于判断是否需要更新阅读次数）
  3. 更新总点击量
  4. 更新今日/本周/本月点击量
  5. 更新最后阅读时间
- **响应**: 操作结果

#### 2.8 搜索小说
- **路径**: GET /api/v1/search/novels
- **查询参数**:
  - q: 搜索关键词
  - page: 页码 (默认1)
  - limit: 每页数量 (默认20)
  - search_by: 搜索字段 (title, author, protagonist, word_count)
  - category_id: 分类ID (按分类搜索)
  - keyword: 关键词 (按关键词搜索)
  - show_pending: 是否显示审核中的小说 (默认false)
- **响应**: 搜索结果列表

  - 搜索增强功能：
    - 高级搜索：
      - 多条件组合搜索（使用第三方库如bleve实现全文搜索，匹配度阈值设定为0.6）
      - 搜索字段权重：标题权重1.0，作者权重0.8，主角名称权重0.7，其他字段权重0.5
      - 搜索结果排序：按匹配度、点击量、评分综合排序
      - 综合评分算法：匹配度×0.4 + (点击量权重×0.3) + (评分权重×0.3)
      - 时间衰减因子：对较老的结果应用时间衰减因子，优先展示较新的结果（使用时间衰减公式：weight = 1/(1+0.1*day_diff)）
      - 高级筛选：支持按分类、字数范围、评分范围等条件进行筛选
    - 搜索历史：保存用户搜索历史（使用Redis存储，最多保存20条记录）
      - 智能清理：自动清理重复搜索记录，保留最近的搜索
      - 快捷访问：提供快捷访问最近搜索的功能
    - 热门搜索：
      - 热门词来源：基于近7天的搜索数据统计
      - 更新频率：每小时更新一次
      - 展示数量：最多展示10个热门关键词
      - 热度计算：结合搜索频次和用户点击率计算热度值
      - 分类热门：提供分类下的热门搜索词
    - 搜索建议：
      - 触发机制：用户输入时延迟300ms触发
      - 建议数量：最多显示5条建议
      - 实现方式：使用第三方库如go-fuzzy实现模糊匹配
      - 数据来源：结合搜索历史和热门搜索提供智能建议
      - 智能推荐：基于用户阅读历史推荐可能感兴趣的搜索词
    - 智能搜索：支持错别字纠正（使用第三方库如symspell-go实现快速编辑距离算法）
      - 同义词扩展：搜索时自动扩展同义词，提高搜索命中率
      - 词干提取：使用第三方库如go-nlp进行词干提取，支持词汇变形搜索
    - 搜索性能优化：
      - 搜索缓存：对热门搜索词的结果进行缓存，提高响应速度
      - 搜索索引：使用倒排索引技术提高搜索效率
      - 分布式搜索：支持分布式搜索架构，提高并发处理能力

#### 2.9 删除小说
- **路径**: DELETE /api/v1/novels/:id
- **认证**: JWT token
- **路径参数**: id - 小说ID
- **响应**: 操作结果
- **处理流程**:
  1. 验证用户认证
  2. 验证用户权限（上传用户或管理员可以删除）
  3. 从数据库删除小说记录
  4. 从文件系统删除小说文件
  5. 删除相关评论、评分等关联数据

#### 2.10 设置小说分类和关键词
- **路径**: POST /api/v1/novels/:id/classify
- **认证**: JWT token
- **路径参数**: id - 小说ID
- **请求参数**:
  - category_id: 分类ID
  - keywords: 关键词数组
- **处理流程**:
  1. 验证用户认证
  2. 验证用户阅读进度按照字数位置的百分比是否达到20%以上（简单判断，不需要额外验证）
  3. 检查分类是否存在于分类表中
  4. 为小说设置分类（更新小说分类关联表）
  5. 为小说设置关键词（更新小说关键词关联表，如果关键词不存在则先创建）
  6. 记录分类和关键词设置的用户ID
- **响应**: 操作结果

#### 2.11 获取相关小说推荐
- **路径**: GET /api/v1/novels/:id/recommendations
- **路径参数**: id - 小说ID
- **查询参数**:
  - limit: 推荐数量 (默认3)
- **处理流程**:
  1. 根据小说的分类和关键词查找拥有相同分类或者关键字的小说
  2. 按照阅读量排序，返回匹配度最高的最多3本小说
  3. 对于无阅读量的小说，默认按ID排序
  4. 前端通过本地存储排除用户已读过的小说
- **响应**: 相关小说推荐列表

  - 推荐算法实现：
    - 基于内容的推荐：
      - 推荐规则：推荐拥有相同分类或者关键字的小说
      - 排序方式：按照阅读量排序的最多3本小说作为推荐
      - 无阅读量处理：默认按ID排序
      - 已读过滤：排除本地存储的已读小说
      - 展示方式：向下滚动即可看到
    - 协同过滤推荐：
      - 算法实现：基于用户行为相似性推荐，使用第三方库如go-galib实现用户-物品协同过滤算法
      - 数据来源：用户评分、评论、阅读时长、阅读进度等行为数据
      - 相似度计算：
        - 用户相似度：使用余弦相似度算法计算用户相似度
        - 物品相似度：基于用户行为计算物品相似度
        - 相似度阈值：仅考虑相似度大于0.3的用户或物品
      - 推荐更新：每周更新一次用户相似度矩阵
      - 邻居选择：选择最相似的50个用户或物品作为邻居进行推荐
    - 热门推荐：
      - 计算方式：基于点击量、评分、评论数等综合评分推荐
      - 加权算法：点击量权重0.5、评分权重0.3、评论数权重0.2
      - 时间衰减：对较早的数据应用时间衰减因子（使用时间衰减公式：weight = 1/(1+0.1*day_diff)）
      - 热度计算：综合考虑短期热度（近7天）和长期热度（近30天）
    - 新书推荐：
      - 时间范围：最近7天内上传且审核通过的小说
      - 质量筛选：仅推荐评分高于3星或评论数超过5条的小说
      - 推荐逻辑：按上传时间倒序排列，结合质量指标进行微调
      - 新书扶持：对优质新书给予额外推荐权重
    - 个性化推荐：
      - 算法实现：根据用户阅读历史和偏好推荐，使用第三方库如go-recommend实现基于内容的推荐算法
      - 更新频率：推荐结果每日更新一次
      - 特征提取：
        - 显式特征：用户明确选择的分类、关键词、作者等
        - 隐式特征：基于阅读行为推断的偏好，如阅读时长、完成度等
        - 内容特征：小说的分类、关键词、字数、评分等属性
      - 推荐策略：结合协同过滤和基于内容的推荐，实现混合推荐算法
      - 推荐权重：协同过滤权重0.5、内容推荐权重0.3、热门推荐权重0.2
      - 推荐多样性：确保推荐结果的多样性，避免推荐过于相似的小说
      - 冷启动问题：对新用户使用热门推荐和分类推荐解决冷启动问题
    - 推荐效果评估：
      - A/B测试：通过A/B测试评估不同推荐算法的效果
      - 点击率统计：统计推荐内容的点击率
      - 用户满意度：通过用户反馈评估推荐满意度
      - 推荐准确性：使用准确率、召回率等指标评估推荐准确性
    - 推荐性能优化：
      - 推荐缓存：对用户推荐结果进行缓存，提高响应速度
      - 推荐预计算：定期预计算推荐结果，减少实时计算压力
      - 推荐分页：对推荐结果进行分页，避免一次性返回过多数据

### 4. 分类模块

#### 4.1 获取分类列表
- **路径**: GET /api/v1/categories
- **响应**: 分类列表

#### 4.2 获取分类详情
- **路径**: GET /api/v1/categories/:id
- **路径参数**: id - 分类ID
- **响应**: 分类详细信息

#### 4.3 获取分类下的小说
- **路径**: GET /api/v1/categories/:id/novels
- **路径参数**: id - 分类ID
- **查询参数**:
  - page: 页码 (默认1)
  - limit: 每页数量 (默认20)
  - sort: 排序方式 (newest, popular)
  - show_pending: 是否显示审核中的小说 (默认false)
- **响应**: 分页的小说列表

### 4. 排行榜模块

#### 4.1 获取排行榜
- **路径**: GET /api/v1/rankings
- **查询参数**:
  - type: 排行榜类型 (total, today, week, month)
  - page: 页码 (默认1)
  - limit: 每页数量 (默认20)
  - show_pending: 是否显示审核中的小说 (默认false)
- **响应**: 排行榜列表

### 5. 审核模块

#### 5.1 获取待审核小说列表
- **路径**: GET /api/v1/novels/pending
- **查询参数**:
  - page: 页码 (默认1)
  - limit: 每页数量 (默认20)
- **响应**: 待审核小说列表

#### 5.2 审核小说
- **路径**: POST /api/v1/novels/:id/approve
- **认证**: JWT token
- **路径参数**: id - 小说ID
- **请求参数**: 
  - action: 审核操作 (approve/reject/modify)
  - reason: 审核原因 (可选，用于拒绝或退回修改时的说明)
- **响应**: 审核结果
- **处理流程**:
  1. 验证用户认证
  2. 验证用户权限（必须是管理员）
  3. 验证小说当前状态（必须为pending）
  4. 执行审核操作
  5. 记录审核操作到日志表（关联审核用户ID，使用第三方库如zap记录admin_logs）
  6. 更新小说状态和审核时间
  7. 如果是拒绝或退回修改操作，向上传用户发送系统消息通知
  8. 更新上传用户的审核统计信息
- **错误响应**:
  - 403: 用户权限不足
  - 404: 小说不存在
  - 400: 小说状态不正确，无法审核

#### 5.4 自动审核过期小说
- **路径**: GET /api/v1/novels/auto-expire
- **认证**: JWT token（仅管理员可访问）
- **响应**: 自动处理结果
- **处理流程**:
  1. 验证用户认证和权限（必须是管理员）
  2. 查询超过30天未审核的小说
  3. 将这些小说状态自动设置为"rejected"
  4. 向上传用户发送系统消息通知
  5. 记录自动处理操作到日志表
- **说明**: 该接口可由定时任务调用，或在管理员面板中手动执行

#### 5.3 批量审核小说
- **路径**: POST /api/v1/novels/batch-approve
- **认证**: JWT token
- **请求参数**: 
  - novel_ids: 小说ID数组（最多50个）
  - action: 审核操作 (approve/reject/modify)
  - reason: 审核原因 (可选，用于拒绝或退回修改时的说明)
- **响应**: 批量审核结果（包含成功数量、失败数量、失败详情等）
- **处理流程**:
  1. 验证用户认证
  2. 验证用户权限（必须是管理员）
  3. 验证小说ID数组的有效性（最多50个ID）
  4. 验证所有小说当前状态（必须为pending）
  5. 对每个小说执行审核操作
  6. 记录审核操作到日志表（关联审核用户ID，使用第三方库如zap记录admin_logs）
  7. 更新小说状态和审核时间
  8. 如果是拒绝或退回修改操作，向相应上传用户发送系统消息通知
  9. 返回批量审核结果统计
- **错误响应**:
  - 403: 用户权限不足
  - 400: 请求参数无效（如超过50个ID）
  - 400: 部分小说状态不正确，无法审核

#### 5.4 审核时效管理
- **说明**: 小说在审核中状态最长保留30天，使用定时任务（使用第三方库如gocron或robfig/cron）每24小时检查一次过期小说，超过期限未审核的小说自动转为拒绝状态并通知上传用户
- **处理流程**:
  1. 使用定时任务每24小时运行一次
  2. 查询超过30天未审核的小说
  3. 将这些小说状态自动设置为"rejected"
  4. 向上传用户发送系统消息通知
  5. 记录自动处理操作到日志表
- **第三方库**: 使用gocron或robfig/cron实现定时任务

#### 5.5 审核标准
- **格式标准**: 文件格式正确，能被阅读器正常解析
- **完整性标准**: 文件无损坏，章节结构完整
- **元数据标准**: 标题、作者等元数据完整且格式正确
- **大小标准**: 文件大小在合理范围内（最小1KB，最大20MB）
- **内容标准**: 无明显乱码、特殊字符等影响阅读的内容
- **审核流程**: 使用第三方库如validator实现审核标准的自动化检查
- **自动审核**:
  - 格式检测：自动检测文件格式和结构
  - 元数据验证：验证标题、作者等信息的完整性
  - 内容初步检查：使用第三方库如go-runewidth检查内容编码
- **人工审核**: 对自动审核通过的文件进行人工质量检查
- **审核质量控制**:
  - 审核员培训：对审核员进行培训，确保审核标准一致
  - 审核抽查：定期抽查审核结果，确保审核质量
  - 审核反馈：收集上传用户对审核结果的反馈

#### 5.6 批量审核处理
- **批量操作错误处理**: 当批量审核中出现部分失败时，记录失败项并返回成功与失败的详细统计
- **部分成功处理**: 成功项正常更新状态，失败项保持原状态并记录错误原因
- **事务处理**: 使用数据库事务确保批量操作的一致性
- **通知机制**: 批量审核完成后向上传用户发送系统消息通知
- **批量操作限制**: 单次批量操作最多处理50个文件，避免长时间占用系统资源
- **进度反馈**: 对大批量操作提供进度反馈，管理员可查看处理进度
- **批量审核优化**:
  - 批量查询优化：使用批量查询减少数据库访问次数
  - 并发处理：对批量操作进行适当的并发处理
  - 内存管理：控制批量操作的内存使用，避免内存溢出

### 6. 评论模块

#### 6.1 发布评论
- **路径**: POST /api/v1/comments
- **认证**: JWT token
- **请求参数**:
  - novel_id: 小说ID
  - chapter_id: 章节ID
  - parent_id: 父评论ID (可选)
  - content: 评论内容（使用bluemonday库进行XSS过滤，最多500字符）
- **响应**: 评论信息
- **处理流程**:
  1. 验证用户认证
  2. 检查用户是否被冻结（is_active字段）
  3. 验证参数完整性
  4. 使用bluemonday库过滤内容中的恶意代码
  5. 检查用户对同一章节的评论数量是否超过限制（5条）
  6. 保存评论到数据库（关联用户ID），评论立即可见
  7. 更新用户评论计数

  - 评论管理：
    - 评论排序：
      - 按时间排序：最新评论优先或最旧评论优先（使用第三方库如go-funk进行数据排序处理）
      - 按点赞数排序：点赞数高的评论优先
      - 按热度排序：结合点赞数、评论时间、回复数等因子计算热度值
      - 热度算法：使用第三方库如go-funk计算热度值，公式为(点赞数)/pow((发布时间-当前时间)/1000+2, 1.8)
        - 热门评论：24小时内点赞数超过10的评论置顶显示
    - 评论限制：
      - 同章节评论数：每个用户对同一章节的评论数量限制为5条
      - 评论长度：评论内容最多500字符
      - 评论频率：同一用户连续评论间隔不少于30秒（使用第三方库如golang.org/x/time/rate实现频率限制）
    - 评论互动：
      - 评论回复：支持对评论进行回复，形成评论线程
      - 评论点赞：用户可以对评论进行点赞，但不能重复点赞
    - 评论管理功能：
      - 评论编辑历史：保存评论编辑历史记录（仅用户和管理员可见）
      - 评论统计：统计评论相关的数据（如评论数、回复数、点赞数等）
      - 评论导出：支持导出评论数据（管理员功能）

#### 6.2 获取评论列表
- **路径**: GET /api/v1/comments
- **查询参数**:
  - novel_id: 小说ID
  - chapter_id: 章节ID (对小说章节进行评论)
  - parent_id: 父评论ID (可选，如果提供则只获取对该评论的回复)
  - page: 页码 (默认1)
  - limit: 每页数量 (默认5)
  - sort: 排序方式 (likes-按点赞最多, newest-按最新, 默认likes)
- **响应**: 分页的评论列表（包含用户信息，如昵称）

#### 6.3 点赞评论
- **路径**: POST /api/v1/comments/:id/like
- **认证**: JWT token
- **路径参数**: id - 评论ID
- **响应**: 点赞结果
- **处理流程**:
  1. 验证用户认证
  2. 检查用户是否被冻结（is_active字段）
  3. 验证评论存在性
  4. 检查同一用户是否已点赞（通过用户ID防止重复点赞）
  5. 更新评论的点赞数
  6. 记录点赞状态（使用用户ID和评论ID的组合防止重复点赞）
  7. 更新用户的点赞记录

#### 4.4 删除评论
- **路径**: DELETE /api/v1/comments/:id
- **路径参数**: id - 评论ID
- **响应**: 操作结果

### 7. 阅读进度模块

#### 7.1 保存阅读进度
- **路径**: POST /api/v1/novels/:id/progress
- **认证**: JWT token
- **路径参数**: id - 小说ID
- **请求参数**:
  - progress: 阅读进度（百分比，0-100）
  - chapter_id: 当前章节ID（可选）
  - position: 在章节中的位置（可选）
- **处理流程**:
  1. 验证用户认证
  2. 检查用户是否被冻结（is_active字段）
  3. 验证小说存在性
  4. 保存用户阅读进度到数据库（关联用户ID和小说ID）
  5. 更新小说的最后阅读时间
- **响应**: 操作结果

  - 阅读统计：
    - 记录阅读时长：
      - 统计规则：仅在页面可见且用户有交互时统计，暂停超过30秒则暂停计时
      - 实现方式：使用第三方库如time计算阅读时间
      - 活跃度判断：结合页面可见性API和用户交互事件判断用户是否在阅读
      - 统计精度：精确到分钟，避免重复计算同一时间段
      - 累计统计：支持累计阅读时长统计，包括日、周、月、年维度
    - 统计阅读速度：
      - 计算方式：每分钟阅读字数，使用第三方库如gonum进行数据分析
      - 速度分析：分析用户在不同时间段的阅读速度变化
      - 个性化建议：根据阅读速度提供章节长度建议
    - 阅读行为分析：
      - 阅读路径：记录用户在小说中的阅读路径，分析阅读习惯
      - 章节偏好：统计用户偏好的章节类型和内容
      - 阅读时段：分析用户的最佳阅读时间
      - 阅读完成度：统计用户对小说的完成度
    - 阅读报告：
      - 生成阅读报告（每日、每周、每月阅读统计）
      - 报告内容：包括阅读时长、阅读速度、完成小说数、阅读偏好等
      - 报告格式：支持多种报告格式（JSON、CSV等）
    - 统计数据处理：
      - 统计精度：阅读时长以分钟为单位，阅读速度以字/分钟为单位
      - 隐私保护：阅读统计数据仅用户本人可见
      - 数据聚合：支持按时间范围聚合阅读统计数据
      - 数据导出：支持用户导出自己的阅读统计数据
    - 阅读成就系统：
      - 阅读里程碑：设置阅读时长或字数里程碑（如"阅读达人"、"万卷王"等）
      - 成就记录：记录用户达成的阅读成就
      - 成就统计：统计用户各项阅读成就的达成情况

#### 7.2 获取阅读进度
- **路径**: GET /api/v1/novels/:id/progress
- **认证**: JWT token
- **路径参数**: id - 小说ID
- **响应**: 用户阅读进度信息

#### 7.3 获取用户阅读历史
- **路径**: GET /api/v1/users/reading-history
- **认证**: JWT token
- **查询参数**:
  - page: 页码 (默认1)
  - limit: 每页数量 (默认20)
- **响应**: 分页的阅读历史列表（包含小说信息和阅读进度）

#### 7.4 批量保存阅读进度
- **路径**: POST /api/v1/novels/progress/batch
- **认证**: JWT token
- **请求参数**:
  - progresses: 阅读进度数组，每项包含 novel_id, progress, chapter_id, position
- **处理流程**:
  1. 验证用户认证
  2. 检查用户是否被冻结（is_active字段）
  3. 批量验证小说存在性
  4. 批量保存用户阅读进度到数据库
- **响应**: 操作结果

#### 7.5 跨设备阅读进度同步
- **说明**: 支持跨设备同步阅读进度，当用户在多个设备上同时阅读时，以最新的阅读进度为准进行同步；如果多个设备时间戳相同，则以进度百分比更高的为准
- **处理流程**:
  1. 保存阅读进度时，记录时间戳
  2. 获取阅读进度时，比较时间戳以确定最新进度
  3. 如果时间戳相同，则比较进度百分比，返回更高的值
  4. 同步失败时的处理：本地缓存进度，稍后重试同步
- **第三方库**: 使用第三方库如time处理时间戳比较
- **冲突解决策略**:
  - 进度冲突检测：比较时间戳和进度百分比
  - 提供接口供前端处理选择保留哪个进度
  - 智能合并：自动合并阅读记录，保留完整的阅读轨迹
    - 章节合并：按章节为单位合并不同设备的阅读记录
    - 时间权重：优先保留更新时间较近的阅读进度
    - 进度比较：如时间相同则保留进度更高的记录
  - 自动处理策略：提供默认处理方式，用户可设置偏好（如总是保留最新进度）
- **同步失败处理**:
  - 重试机制：使用第三方库如go-retry实现重试机制（最多重试3次，间隔时间递增）
  - 失败记录：记录同步失败的情况，便于后续处理
  - 离线支持：标记本地进度为待同步状态，网络恢复时自动同步
- **阅读时长统计**:
  - 统计规则：仅在页面可见且用户有交互时统计，暂停超过30秒则暂停计时
  - 实现方式：使用第三方库如time计算阅读时间
  - 统计精度：精确到分钟，避免重复计算同一时间段
  - 数据聚合：支持按日、周、月聚合阅读时长数据
- **同步性能优化**:
  - 增量同步：仅同步变化的进度数据，减少传输量
  - 批量处理：支持批量同步多个小说的进度
  - 缓存机制：对频繁访问的进度数据进行缓存

### 9. 评分模块

#### 8.1 评分
- **路径**: POST /api/v1/ratings
- **认证**: JWT token
- **请求参数**:
  - novel_id: 小说ID
  - rating: 评分 (1-5)
  - review: 评分说明（对小说的评论，最多250个字符，非必填）
- **响应**: 评分信息
- **处理流程**:
  1. 验证用户认证
  2. 检查用户是否被冻结（is_active字段）
  3. 验证参数完整性
  4. 如果评分说明不为空，使用bluemonday库过滤评分说明中的恶意代码
  5. 检查用户是否已对同一小说评分
  6. 保存评分到数据库（关联用户ID），评分立即可见

  - 评分统计：
    - 实时计算平均分（使用第三方库如decimal实现精确计算）
    - 评分分布统计（各星级评分数量及占比）
    - 评分趋势分析（记录评分时间变化趋势）
    - 评分可信度评估：
    - 用户活跃度指标：基于用户评论数、上传小说数、阅读时长等计算活跃度
    - 评分权重：活跃度高的用户评分权重更高（使用第三方库如decimal计算加权平均分）
    - 评分过滤：对异常评分（如短时间内大量评分）进行过滤
      - 评分频率检测：使用第三方库如golang.org/x/time/rate检测用户评分频率
      - 评分模式分析：分析用户评分模式，识别刷分行为
      - 评分时间间隔：检测评分时间间隔，过滤异常评分
    - 评分验证：对评分内容进行质量评估，内容长度和质量作为可信度指标
    - 评分可信度计算：
      - 基础可信度：根据用户活跃度计算基础可信度（范围0-1）
      - 行为可信度：根据评分行为模式调整可信度（如评分分布是否合理）
      - 内容可信度：根据评分说明的内容质量评估可信度
      - 综合可信度：结合以上三种可信度计算综合可信度
      - 实现方式：使用第三方库如decimal进行可信度计算
    - 评分展示优化：
      - 可信度标识：在评分数据中包含可信度标识
      - 可信度过滤：提供按可信度过滤评分的API
      - 可信度排序：提供按可信度对评分进行排序的API
    - 评分质量监控：
      - 异常评分检测：监控评分模式中的异常行为
      - 可信度趋势：跟踪用户可信度的变化趋势
      - 评分一致性：分析用户评分与其他用户的评分一致性

#### 9.2 获取评分
- **路径**: GET /api/v1/ratings/:novel_id
- **路径参数**: novel_id - 小说ID
- **响应**: 评分信息（如果用户已登录，还包括该用户是否已评分、评分值等信息）

#### 9.3 获取小说评分列表
- **路径**: GET /api/v1/novels/:novel_id/ratings
- **路径参数**: novel_id - 小说ID
- **查询参数**:
  - page: 页码 (默认1)
  - limit: 每页数量 (默认20)
- **响应**: 分页的评分列表（包含评分、评分说明、点赞数、用户信息，如昵称）

#### 8.5 点赞评分
- **路径**: POST /api/v1/ratings/:id/like
- **认证**: JWT token
- **路径参数**: id - 评分ID
- **响应**: 点赞结果
- **处理流程**:
  1. 验证用户认证
  2. 检查用户是否被冻结（is_active字段）
  3. 验证评分存在性
  4. 检查同一用户是否已点赞（通过用户ID防止重复点赞）
  5. 更新评分的点赞数
  6. 记录点赞状态（使用用户ID和评分ID的组合防止重复点赞）

## 文件管理

### 1. 文件上传
- 支持txt、epub格式
- 文件大小限制（最大20MB）
- 文件类型验证（使用filetype库）
- 安全扫描
- 字数统计计算
- 主角名称提取
- 文件hash验证（使用crypto/sha256库防止重复上传）
- 上传进度跟踪
- 上传后默认为审核中状态
- 上传失败时返回错误信息给用户
- 文件上传处理（使用mime/multipart库处理文件上传，使用filetype库检测文件类型，使用golang.org/x/time/rate库实现上传速率限制）

  - 解析失败处理：
    - 如果解析失败，系统会记录错误日志并向前端返回错误信息
    - 解析失败的小说在数据库中标记为特殊状态，但仍保留文件以供下载
    - 使用第三方库如DOMPurify进行内容安全过滤

### 2. 文件存储
- 本地文件系统存储

  - 文件存储路径管理：
    - 按状态分目录存放：
      - 审核中文件：存放在 pending 目录
      - 已通过文件：存放在 approved 目录  
      - 已拒绝文件：存放在 rejected 目录
    - 目录容量管理：每个目录最多存放500个小说文件，超过则新建子目录存放（如 approved/001/, approved/002/ 等）
    - 访问控制：使用第三方库如net/http实现文件访问控制，所有小说文件访问需经过后端API验证，防止直接访问文件路径
    - 使用第三方库如os和path/filepath管理文件路径
    - 自动清理机制：
      - 清理规则：定期清理超过30天的临时文件和失败的上传文件
      - 清理频率：每日凌晨3点执行清理任务
      - 清理范围：包括pending目录中超过30天的未审核文件、临时上传目录中的失败文件
      - 安全机制：
        - 清理前记录日志，避免误删正在处理的文件
        - 文件锁定检测：检测文件是否被其他进程使用
        - 清理确认：对大文件或重要目录执行二次确认
      - 实现方式：使用第三方库如gocron实现定时任务
      - 监控告警：监控存储空间使用情况，超过阈值（如80%）时发送告警
      - 清理报告：生成清理报告，记录清理的文件数量和大小
      - 清理验证：清理后验证文件是否真正被删除
      - 清理备份：对重要文件在清理前进行备份（可选配置）
- 文件路径管理
- 文件访问控制

### 3. 静态文件服务
- 小说文件访问
- 图片文件访问
- 缓存策略
- 安全访问控制

## 认证与授权

系统使用JWT进行用户认证和授权：
- 使用JWT token进行用户认证（使用第三方库如github.com/golang-jwt/jwt/v4）
- 受保护的API端点需要有效的JWT token
- 管理员权限通过用户角色或特定字段验证
- 文件hash验证防止重复上传（使用crypto/sha256库）
- 小说上传后默认为审核中状态
- 管理员审核机制
- 用户操作频率限制
- 敏感操作验证（如删除操作）
- 内容审核机制
- 用户评论和评分限制：每个登录用户对同一个小说只能评论最多10次，对小说的章节评论最多10次，对评论或评分的点赞限制为同一用户只能点赞一次
- 用户个性化数据（如点赞状态）通过用户ID关联到服务器
- 冻结用户限制：被冻结用户无法进行上传、评论、评分等操作

## 数据验证

### 1. 输入验证
- 请求参数验证（使用validator库）
- 数据格式验证（使用validator库）
- 业务规则验证（使用自定义验证函数）

### 2. 错误处理
- 统一错误响应格式
- 错误码定义
- 错误信息本地化

## 日志管理

### 1. 访问日志
- 请求记录
- 响应时间
- 用户行为追踪

  - 访问日志增强：
    - 记录用户IP地址（使用第三方库如net包获取）
    - 记录请求耗时（使用第三方库如zerolog记录性能指标）
    - 记录用户设备信息（User-Agent解析，使用第三方库如ua-parser）
    - 记录API调用频率统计

### 2. 错误日志
- 异常记录
- 错误追踪
- 堆栈信息

  - 错误日志增强：
    - 错误分类标记（按错误类型分类）
    - 错误影响评估（记录错误对系统的影响程度）
    - 错误追踪ID（为每个错误生成唯一追踪ID）
    - 错误上报机制（使用第三方库如sentry-go上报严重错误）

### 3. 业务日志
- 用户操作记录
- 数据变更记录
- 审计日志

  - 业务日志增强：
    - 操作轨迹追踪（记录用户完整的操作轨迹）
    - 数据变更对比（记录数据变更前后的对比）
    - 安全事件记录（记录登录、权限变更等安全相关事件）

## 性能优化

### 1. 数据库优化
- 索引设计（对click_count、today_clicks、week_clicks、month_clicks等字段建立索引）
- 查询优化
- 连接池管理

  - 数据库性能增强：
    - 读写分离（使用第三方库如gorm的主从库配置）
    - 分库分表（按时间或用户ID分表，使用第三方库如go-sql-driver实现）
    - 查询缓存（对频繁查询的结果进行缓存）
    - 批量操作优化（使用gorm的批量插入更新功能）

### 2. 缓存策略
- Redis缓存集成
- 热点数据缓存
- API响应缓存
- 排行榜数据缓存
- 字数统计缓存

  - 缓存策略增强：
    - 多级缓存（L1内存缓存+L2 Redis缓存，使用第三方库如bigcache）
    - 缓存预热（系统启动时预加载热门数据）
    - 缓存穿透防护（使用布隆过滤器，第三方库如bloom）
    - 缓存雪崩防护（设置随机过期时间）

### 3. API优化
- 数据分页
- 字段选择
- 批量操作
- 点击量更新的异步处理
- 排行榜数据的缓存优化

  - API性能增强：
    - API限流（使用令牌桶算法，第三方库如golang.org/x/time/rate）
    - 响应压缩（使用gzip压缩响应数据）
    - 响应缓存（对静态数据进行HTTP缓存）
    - 异步处理（使用消息队列处理耗时操作，第三方库如go-redis实现简单队列）

## 安全性

### 1. 数据安全
- 防止SQL注入
- 防止XSS攻击（使用bluemonday库进行内容过滤）
- 输入内容过滤和验证（使用bluemonday库进行XSS防护）

### 2. 文件安全
- 文件类型验证（使用filetype库）
- 文件大小限制
- 恶意文件检测
- 上传路径安全
- 文件hash验证（使用crypto/sha256库防止重复上传）

### 3. 访问控制
- API访问频率限制（使用golang.org/x/time/rate库）
- 敏感操作验证
- 操作频率限制
- 审核权限控制

## 配置管理

### 1. 环境配置
- 开发、测试、生产环境
- 配置文件管理
- 环境变量使用

### 2. 服务配置
- 数据库连接配置
- 文件上传限制配置
- 审核配置

## 部署

### 1. Docker支持
- Dockerfile编写
- Docker Compose配置
- 多环境部署

### 2. 监控
- 健康检查接口
- 性能监控
- 错误监控

## 第三方库使用

- Gin: Web框架
- Gorm: ORM框架
- Viper: 配置管理
- Logrus: 日志管理
- filetype: 文件类型检测
- golang-epub: EPUB格式处理
- golang.org/x/time/rate: 速率限制
- validator: 数据验证
- bluemonday: XSS防护
- go-redis: Redis缓存
- bcrypt: 密码哈希
- mime/multipart: 文件上传处理